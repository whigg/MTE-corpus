1870.PDF
FITS  FORMAT  FOR  PLANETARY  SURFACES:  BRIDGING  THE  GAP  BETWEEN  FITS  WORLDCOORDINATE SYSTEMS AND GEOGRAPHICAL INFORMATION SYSTEMS.  C. Marmo1, T.M. Hare2, S.Erard3, B. Cecconi3, F. Costard1, F. Schmidt1 and A. P. Rossi4, 1GEOPS, Univ. Paris-Sud, CNRS, Univ. Paris-Saclay,Rue  du  Belvédère,  Bât.  509,  91405  Orsay,  France,  chiara.marmo@u-psud.fr,  2U.  S.  Geological  Survey,Astrogeology Science  Center,  Flagstaff,  AZ,  3LESIA,  Observatoire  de  Paris,  PSL Research  University,  CNRS,Sorbonne Universités, UPMC Univ. Paris 06, Univ. Paris Diderot, Sorbonne Paris Cité , Meudon, France,  4JacobsUniversity, Bremen, Germany.Introduction:  The  amount  of  available  data  israpidly  increasing  for  planetary  investigations  andplanetary  surface  research  continues  to  evolve  frommostly  visual  assessment  to  more  automatedquantitative analysis.Both  geologists  and  now  more  astronomers  areinvolved in mapping planetary surfaces. Geologists, fortheir  mapping  and  analysis  needs,  commonly  useGeographical  Information Systems (GIS).  In  general,GIS  applications  excel  in  data  interoperability  eventhough some have historically been anchored to Earth'sspatial description. Astronomers, in contrast, are wellknown for their open and flexible formats and softwarefor  quantitative  analysis  of  huge  data  sets.Unfortunately,  the  astronomy  domain  is  notaccustomed  to  supporting  data  for  three-dimensionalplanetary surfaces.This  abstract  will  describe  how  Flexible  ImageTransport  System  (FITS) World  Coordinate  System(WCS) [1] metadata can be translated for the planetarydomain to  allow FITS data to  interoperate  with GISapplications.In  particular,  we  will  discuss  the  translationbetween WCS and Planetary Data System (PDS) andIntegrated  Software  for  Imagers  and  Spectrometers(ISIS) format terminology and an alternative approachto  convert  FITS  into  a  Geospatial  Data  AbstractionLibrary (GDAL) Virtual Header Format (VRT) [2] as afirst step for FITS visualization within GIS software.Why  FITS: FITS  has  been  defined  for  dataacquisition and archiving in astronomical observatoriesand is used for spatial telescope data. FITS is one ofthe standard formats in the Virtual Observatory (VO),it is compatible with PDS archiving specifications andsupported  by  a  large  number  of  open  libraries  andsoftware  tools.  The  option  to  use  FITS  within  theplanetary  domain  could  be  an  opportunity  to  allowmore  seamless  sharing of  data  across  these differentdomains  and  potentially  homogenize  methods  fromacquisition, to visualization, while giving more chancesto optimize data processing.FITS WCS: FITS WCS representation simplifiesthe  spatial  coordinate  description  with  respect  tohistorical  terrestrial  references.  There  is  no  need  foroblique  projection  definitions  [3,4]  as  projectionparameters  (projection  center  or  reference  point)describe  the  difference  between  the  Mercator  andTransverse  Mercator  or  Simple  Cylindrical  andEquirectangular map projections. There is no need forEast or West positive longitude definitions as the pixelconversion in world coordinates is set  by a commonoriented matrix. However,  if  still  needed,  FITS  does  offer  thepossibility  to  fully  describe  those  same  parametersusing  alternative  WCS  definitions  (meters,  degrees,East and West longitude, etc.) [5]. Nevertheless, WCSdoes not record information about the body shape andorientation, and reference surface. This limitation mustbe addressed to support surface studies.PDS/ISIS dictionaries as Mapped to FITS: Table1 contains the translation between FITS and PDS/ISISnomenclature  for  the  most  popular  projections.  Theconversion between projection parameters depends onprojection  type,  thus  as  an  example,  Table  2  givesconversion for cylindrical projections in degrees.Table 1. ProjectionsFITS FITS projection name PDS/ISIS projection nameSFL Sanson-Flamsteed Sinusoidal ZEA Zenithal Equal-Area Lambertazimuthalequalarea COO Conic orthomorphic Lambertconformal CAR plate carre Equirectangular MER Mercator Mercator SIN Orthographic Orthographic AZP Zenithal perspective Pointperspective STG Stereographic Polarstereographic Table  2.  Parameters  for  cylindrical  projections(coordinates in degrees)FITS parameter ISIS conversion PDS conversionCRPIX1 Samples / 2 + 0.5 LINE_SAMPLES / 2 + 0.5CRPIX2 Lines / 2 + 0.5 LINES / 2 + 0.5CRVAL1 CenterLongitude CENTER_LONGITUDECRVAL2 CenterLatitude CENTER_LATITUDECD1_1, CD2_2  1 / Scale 1 /  MAP_RESOLUTIONFITS  and  GDAL:  The  Geospatial  DataAbstraction  Library,  released  by  the  Open  Source1870.pdf
47th Lunar and Planetary Science Conference (2016)
Geospatial  Foundation,  offers  powerful  dataconversion  and  processing  capabilities.  GDAL  isessentially a format translation library written in C++for geospatial raster and vector data [6]. In 2007, theISIS2  and  PDS  readers  were  updated  and  ISIS3support was added. Any application which supports theGDAL library can now easily recognize these planetarydata formats, including the planet definition, projectionparameters,  and  label  information  like  pixel  valueoffset and multiplier.Fortunately,  GDAL also has support  for FITS viathe popular CFITSIO library [7]. Next we discuss someof the known issues that should be addressed in GDAL,besides  our  needed  FITS  keywords  to  supportgeospatial  applications.  We  will  also  discuss  analternative method to more quickly add GIS support forFITS  images  using  a  GDAL-supported  detachedheader.Known Issues: Similar to PDS, FITS often stores pixels as a result of aquantization  (i.e.  conversion  from  real  numbers  tointegers  while  maintaining  an  offset  and  multipliervalue to allow the original range to be recovered). Tofacilitate  analysis,  without  user  intervention,  GDALshould apply the defined offset and multiplier valuesbefore  returning  data  to  the  user.  FITS  images  arealways  stored  as  signed  integers  and  the  supportedBZERO  and  BSCALE  keywords  (corresponding  tooffset and multiplier in ISIS) also allow FITS to bettersupport  unsigned  data  range.  The  CFITSIO  libraryautomatically  manages  conversion  between  differentdata  types in FITS,  but  currently CFITSIO rescalingcauses overflows with GDAL and has been disabled. During the conversion from PDS and ISIS, or evenTIFF, the GDAL readers do not automatically scale thepixel  values  and  depend  on  the application to  applythese  adjustments  for  the  user.  By  updating  thisBZERO and BSCALE behavior in GDAL within theFITS format, it would be a good opportunity to addressthis  limitation  in  the  ISIS  and  PDS  readers  andpossibly  offer  this  dynamic  adjustment  within  allsupported GDAL formats.GDAL Virtual Header:The  VRT  format  is  a  verbose  XML-based  detachedheader  created  by  the  GDAL  team.  It  is  a  verypowerful  mechanism to  describe  diverse  images  (orgroups of images – for example a virtual mosaic). VRTfiles  can  simply describe  the  internal  structure  of  aFITS image but it can also describe the map projectionand  body  size  in  a  standardized  "well  known  text"(WKT)  projection  string.  Unfortunately,  the  currentFITS implementation in GDAL does not propagate allthe original metadata into the output VRT file but thiswill  be  updated.  For  FITS  VRT  examples  andconversion  tools  please  see:  https://github.com/epnvespa/fits2vrt.Shape  and  orientation  keywords:  Generally,planetary body shapes and orientations are well definedand  standardized  by  the  International  AstronomicalUnion  (IAU)  Working  Group  on  CartographicCoordinates  and  Rotational  Elements  (WGCCRE).This group reports triennially on the preferred rotationrate,  spin axis, prime meridian, and reference surfacefor  planets  and  satellites  which  helps  ensure  thatcartographic endeavors are effectively comparable [8].In  the  framework  of  the  European  VirtualObservatory project  (VESPA) [9]  a FITS conventionfor planetary data will be proposed [10] following theWGCCRE schema. Future  work:  In  the  coming  months  the  newkeywords  to  allow FITS  to  support  planetary bodieswill  be  defined  and  tested.  Once  the  proposedgeospatial extensions are fully agreed upon and addedinto  FITS,  the  GDAL  library  will  be  updated  toproperly map these new keywords. To help contributeor  follow updates  to  the  GDAL FITS  driver,  pleasesee:  https://github.com/epn-vespa/gdal.References:[1]  http://fits.gsfc.nasa.gov/fits_wcs.html.  [2]http://www.gdal.org/gdal_vrttut.html.  [3] Snyder,  J.  P.(1987)  Professional  paper:  USGS,  U.S.  GovernmentPrinting Oﬃce. [4] Calabretta, M. R.  and Greisen, E.W. (2002) A&A, 395:1077–1122. [5] Greisen, E. W.and Calabretta,  M. R. (2002)  A&A, 395:1061–1075.[6] Hare, T.M., et al. (2007), LPSC 39, abs #2536, [7]http://heasarc.gsfc.nasa.gov/fitsio/fitsio.html.  [8]Archinal, B.A., et al. (2011), Celestial Mechanics andDynamical  Astronomy,  109,  no.  2,  Feb.,  101-135,doi:10.1007/s10569-010-9320-4. [9]  http://europlanetvespa.eu/ [10] https://epn-vespa.github.io/geofits/.Acknowledgments:   This  work  benefits  fromsupport  of  VESPA/Europlanet.  The Europlanet  2020Research  Infrastructure  is  funded  by  the  EuropeanUnion under the Horizon 2020 research and innovationprogramme, grant agreement N° 654208.1870.pdf
47th Lunar and Planetary Science Conference (2016)
