 DETECTING CRATERS ON LUNAR SURFACE USING AN ADABOOST METHOD.  Zhou-Bin Zhang, Wei Zuo, Chun-Lai Li, Yong-Liao Zou, Guang-Liang Zhang and Xing-Guo Zeng, Key Laboratory of Lunar and Deep Space Exploration, National Astronomical Observatories, Chinese Academy of Science, Beijing 100012, China, zzbin@nao.cas.cn.   Introduction:  Lunar craters are key geomorphological structures formed by the impacts of a meteoroid, asteroid or comet with the planetary surface. Through the process of impact cratering over a long period, the accumulated impact craters offer us a tool for interpreting planetary surfaces, and the modification of the crater shapes by erosion, dust deposition, lava flow coverage, etc., also provides critical information about geological processes of the planet. Dating of geological units of planetary surfaces is one of the most important subjects of planetary science for understanding a planet's origin and evolution[1]. The method of dating by crater counting has been widely used to infer the lunar geological history, and the lunar cratering chronology formulated by relating crater frequencies to the radiometric ages of Apollo and Luna samples enables us to convert the crater frequencies into absolute ages[2]. Thus, with the huge amount of craters, automatic crater detection on planetary images becomes a routine activity. There are many publications devoted to various techniques of crater detection[3], but the efficiency is quite a problem when much of these methods come to high resolution planetary images due to the extremely high computational complexity. Method: In our study, we employ a method derived from fast face detection technique to detect craters using high resolution images from Chang'E-2 mission. Image preprocessing.  The numerous non-crater morphologies interveined on the lunar surface pose a real challenge on  effectively identifying the exact craters from a very complicated circumstance. So, besides some necessary enhancements such as image intensity, sevel filters are intentionally applied to suppress the adverse effect introduced by complicated topography on lunar surface: 1)large window median filter to significantly blur the little features in the image, then the  filted result is subtracted from the original one, which can eliminate the interference caused by large-scale morphologies such as montes; 2) power filter constructed on grayscale value variation and area, these two attributes are jointly used to filter out both large terrains with low intensity and very small terrains but with high intensity; 3)area filter to finally removed very small features survived after the filtering by the previous two filters. Candidate craters identifying.  The preliminary candidate craters are identified by a simple method with low criterion to include the majority of all the true craters but with a high false positive detecting rate, which subsequently provide a promising crater candidates list to a fine-tuned classifier described later for an accurate discrimination. With the inherent high computational complexity image processing technique possesses, such method removed numerous background objects and obvious non-crater ones with a relatively low cost, dramatically decreasing the computational workload for further identification. After the mentioned image preprocssing, canny operator is employed to calculate the edges of a variety of morphologies in the image, which finally result in a 2-bit image. Then, using pre-defined Rmax and Rmin as maximum and minimum search radiuses, the procedure exhaustively traverses all the pixels in the 2-bit image, and counts all 1-pixels that are one radius(r) away from (x, y). If the number of such pixels is greater than r*Th(a defined threshold), we consider there's a possible crater of centre(x, y) and radius r, and put (x,y,r) into the candidate list. A sub-image of such possible crater of (x,y,r) will be extracted from the original image using a square whose center located at (x,y) and whose length is 2r. All these candidate craters sub-images will pass through a well-trained classifier to find out the real craters. Discrimination using a strong classifer.  The final classifier acting on the candidate list is a highly effective method derived from face detection technique[1]. First of all, 6 Haar-like features are designed to model some basic crater characteristics(Fig. 1), such as crater rim, brightness-shadow pattern produced by illumination, etc. The feature value is calculated by substracting the  sum of all pixels gray value in black area from the one in white area, which can be performed very rapidly on a so-called integral image. Secondly, a library of training samples is constructed based on candidates calculated though previously metioned method using several selected sample images with various morphological characteristics of craters. All the candidates from sample images are visually inspected, so the real crater objects are selected and labeled as positive samples manually(Fig. 2), and non-crater objects are labeled as negative ones(Fig. 3). The sub-image of every sample in the libray is downsample to a uniform pixel size of 24×24. Finally, a strong classifier which consists of hundreds of optimal weak classifiers is trained on the defined samples library using AdaBoost algo rithm. Every feature derived from the 6 basic Haar-like features with different position and size in a 24×24 area forms a weak classifier, all of which are applied on the complete library to judge every sample being crater or non-crater, the one with highest accuracy rate is selected as a optimal weak classifier, then the weight of all misjudged samples by this classifier are increased, allowing the follow-up classifier can pay more attention on those misjudged samples. After T rounds training , a strong classifier consisting of T optimal weak classifiers is constructed. Then, this strong classifier is finally applied on the target candidates which is downsampled to a 24×24 uniform size to discriminate real crater objects from non-crater ones.  Figure 1: 6 Haar-like features   Figure 2: Some positive samples from the library   Figure 3: Some negative samples from the library Result: As a verification of our crater detection method, we developed a strong classifier after 180 rounds training, and selected an image depicting a region with rugged morphology to run a test. The result shows 76% of all obvious craters are detected with a false positive rate of 16%. Experimental result also indicates that the recognition accuracy is not satisfactory when craters are heavily degraded or overlapped, which is a tough challenge we should overcome in our follow-up work(Fig. 4).   Figure 4: A samll example portion of test result.  Future work: The crater detecting method developed in our work show a effective performance on an experimental detection using a test image from Cheng'E-2. The insufficient aspects revealed in the test need more future work to resolve. The performance of strong classifier heavily relys on the selection of weak classifiers in training procedure based on the sample library, so the variety of morphological characteristics expressed by crater or non-crater samples, the ratio of crater/non-crater samples in the library and the optimal number of weak classifiers in the strong classifier need to be seriously considered.   References: [1] Tomokatsu Morota et al. (2008)Earth Planets Space,60,265-270. [2] William K. Hartmann and Gerhard Neukum. (2001)Space Science Reviews, 96, 165-194. [3] Goran Salamunic´car et al. (2011) Planetary and Space Science, 59, 111-131. [4] Erik R. Urbach and Tomasz F. Stepinski. (2009) Planetary and Space Science, 57,  880-887. [5] Viola and Jones. (2004)International Journal of Computer Vision, 57(2),137-154.  