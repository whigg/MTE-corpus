 "GEKKO" FOR HYPERSPECTRAL DATA DISTRIBUTION: A NEW METHOD FOR UTILIZING THE ADVANTAGES OF A WEB MAP SERVICE HAYASHI Yohei, OGAWA Yoshiko1, HIRATA Naru1, TERAZONO Junya1, DEMURA Hirohide1, MATSUNAGA Tsuneo2, OHTAKE Makiko3, and OTAKE Hisashi3, 1The University of Aizu. Tsuruga, Ikki-Machi, Aizu-Wakamatsu, Fukushima 965-8580, Japan. 2National Institute for Environment Studies, 16-2 Onogawa, Tsukuba, Ibaraki 305-8506, Japan. 3Japan Aerospace Exploration Agency, 3-1-1 Yoshinodai, Chuo-ku, Sagamihara-city, Kanagawa 252-5210, Japan. Introduction: The Japanese lunar orbiter Kaguya carried the Spectral Profiler (SP), a visible and nearinfrared spectrometer covering the wavelengths of 0.52.6Âµm with 296 bands, that performed detailed observations of the reflectance spectra on the Moon [1][2]. The SP continuous spactra can be used to obtain information about the lunar surface materials in detail and globally, which would help to clarify the lithological evolution of the Moon. We developed a web geographical information system (GIS) called "GEKKO" ("moonlight" in Japanese) which specializes in handling hyperspectral data for convenient viewing of the SP data. The GEKKO system stored all of the latest SP data products [3][4]. Figure 1 shows an image of GEKKO. One sample of the observed SP spactrum is represented on the lunar base map. GEKKO commenced service in August 2014: the system is operated by CAIST at the University of Aizu [5]. This paper presents the technical details of the latest version of the GEKKO system, which utilizes the great advantages of a Web Map Service (WMS). Data and previous work: JAXA provides all the Kaguya data including SP data products in PDScompatible formats via the "SELENE (Kaguya) Data Archive" web site [6]. The SP product consists of three types of data: spectral data, ancillary data such as its georeference data, and simultaneous observation images. Due to the such irregular structure of the contents, the user cannot access the data simply using applications that accept the PDS format. Terazono et al. [7] developed a web application "WISE-CAPS" with which the user can view SP spectra for a limited area, although the system focuses on supporting collaborative analysis by several researchers. They adopted a Web Feature Service (WFS) as a method for distribution of SP data. We discuss the differences between WFS and WMS latter of which we adopted for GEKKO. System requirements: To develop a hyperspectral data viewer, the following two points should be considered. First, the observation spots are discontinuous, and it is therefore difficult to generate mosaic images for distribution, as there are intervals between the observation swaths located along every track. Second, the data are continuous spectra with high spectral resolution. For example, a single SP spectrum consists of 296 reflectance Figure 1: Appearance of GEKKO application. data. Even if we were to obtain a mosaic image of SP, 296 layers would be prepared in total which is not easy for the user to view them. Thus, the distribution of SP data requires novel technical frame. Distribution methods: Two methods are available for distribution of SP data, i.e., WFS and WMS, following the standards of the Open Geospatial Consortium [8]. In provider side context, WFS is a protocol for distribution of feature data as vector format to a client over the internet. If the SP data are treated as features on WFS, a "GetFeature" request should be used to distribute the SP data. GetFeature is a command whereby the user indicates the bounding box (i.e., a rectangular area indicated by the locations of two points) and gets a response with the features within its area. On the other hand, WMS is a protocol for distribution of map data as an image format to a client over the internet. If the SP data are treated as features on WMS, a "GetFeatureInfo" request distributes the SP data. GetFeatureInfo is a command by which the user indicates a location point on a map layer. The user gets the response from the server accompanied by some features that are linked to the areas requested by the user. A WFS protocol has the ability to distribute a large amount of data. So, the protocol might be a general method for distributing feature data. GetFeature in WFS publishes the data for a large area at a time. GetFeatureInfo in WMS publishes the minimum data at the  Figure 2: System Configuration. user's request. If the user must visualize the SP data, the visualization requires the high computer resource for user-side. Therefore, we focused on the advantages of WMS and adopted it to distribute data through the GEKKO system. Implementation: GEKKO distributes SP data using the GetFeatureInfo request on WMS. A system overview is shown in Figure 2. This web application integrates mainly OpenLayers on the client side, and MapServer on the server side. MapServer distributes three types of data: SP spectral data, background image and SP observational footprint. The spectral data have a table structure consisting of the wavelengths of 296 bands and the observed reflectance of the same number of bands. There are two ways to distribute the SP spectral data to the user: (i) deliver the data themselves, or (ii) deliver a graph generated from the data. GEKKO adopts (i) with the following data flow steps, because the user can modify the graph. First, SP data are distributed using GetFeatureInfo in WMS. The data format is JavaScript Object Notation (JSON), for convenience on the client side. Next, GEKKO Library accepts the JSON format data from the server and draws a spectrum graph in the browser (botom center of Figure 1) on the user side (Figure 2). SP data are not image data. So, background images are necessary to identify the observation spots. GEKKO prepares several images for the base map, such as the mosaic images from the Multi-band Imager on board the Kaguya, the Wide Angle Camera on board Lunar Reconnaissance Orbiter (LRO), and the topographic map from the Lunar Orbiter Laser Altimeter on board LRO. In addition, GEKKO is able to show simultaneous observation images from TC or MI at full resolution as background images. These background images are distributed using "GetMap" requests in WMS. The distribution of SP footprints is critically important, as the footprints on the background image (base map) are the keys to link the features with locations. Upon receipt of a GetMap request in WMS, the footprints are distributed as an image layer from the server after rendering by MapServer. With regard to the GetFeatureInfo request in WMS, the response is limited to the area where the footprints are displayed. The footprints can be categorized into several groups according to various criteria and visualized accordingly. In Figure 1, the footprints are color-corded to indicate the Kaguya spacecraft altitude; the lower the altitude is, the better the data quality becomes (S/N ratio and spatial resolution). Thus the user can easily check whether such data are available for the region of interest. In addition, GEKKO offers a function wherein the user can choose to show or hide the groups of footprints according to their preference. Conclusion: GEKKO is a unique system using a new method for distributing hyperspectral data. GEKKO focuses on the simplicity and convenience of viewing the SP data on a web browser, rather than distributing massive data at a time. Taking advantage of WMS, the GEKKO system succeeds in displaying the SP observation footprints categorized according customized criteria on the base map, which helps in visualization of the hyperspectral data. The difference between WFS and WMS for distribution of SP data is remarked as the difference of which side the data are visualized on: the user side in WFS or the server side in WMS. If a system does not require to distribute a large amount of data at a time, and the data provider can prepare visualized data from hyperspectral data, the WMS method is recommended. References [1] JAXA. LISM [Terrain Camera (TC), Multi band Imager (MI), Spectral Profiler (SP)]. http://www.kaguya. jaxa.jp/en/equipment/tc_e.htm accessed 2016.1.4. [2] Matsunaga, T. et al. Discoveries on the lithology of lunar crater central peaks by SELENE spectral profiler. Geophys. Res. Lett., Vol. 35, No. 23, 2008. DOI:10.1029/2008GL035868. [3] Hayashi, Y. et al. Web GIS system Gekko for data analysis of Kaguya's Spectral Profiler. JAXA Res. and Dev.: J. of Space Sci. Info. Japan, Vol. 14, pp. 91-104, 2015. [4] Ogawa, Y. et al. A web-GIS for the Kaguya/spectral profiler data, "GEKKO" (moonlight in Japanese): toward comprehensive mapping of the surface minerals on the Moon. In European Planetary Sci. Congress 2015, Vol. 10, p. 468, 2015. [5] CAIST, the University of Aizu. GEKKO. http://fructus.u-aizu.ac.jp/gekko_ info/en/index.html accessed 2015.1.4. [6] JAXA. SELenological and ENgineering Explorer; SELENE Data Archive. http://l2db.selene. darts.isas.jaxa.jp/index.html.en accessed 2015.1.5. [7] Terazono, J. et al. Recent advancement of system development of WISE-CAPS: a WebGIS-based lunar and planetary data collaboration system. In Lunar and Planetary Sci. Conf., Vol. 46, p. 1725, 2015. [8] Open Geospatial Consortium. OGC Standards. http:// www.opengeospatial.org/docs/is/ accessed 2015.1.7.  http://www.kaguya.jaxa.jp/en/equipment/tc_e.htm http://www.kaguya.jaxa.jp/en/equipment/tc_e.htm http://fructus.u-aizu.ac.jp/gekko_info/en/index.html http://fructus.u-aizu.ac.jp/gekko_info/en/index.html http://l2db.selene.darts.isas.jaxa.jp/index.html.en http://l2db.selene.darts.isas.jaxa.jp/index.html.en http://www.opengeospatial.org/docs/is/ http://www.opengeospatial.org/docs/is/	Introduction	Data and previous work	System requirements	Distribution methods	Implementation	Conclusion