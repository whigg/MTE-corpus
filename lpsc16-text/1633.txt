 PHOTOMETRIC HAPKE CORRECTION FOR GLOBAL-SCALE MOSAICKING OF HRSC IMAGE DATA S. H. G. Walter1 (sebastian.walter@fu-berlin.de), J.-Y. Li2, T. Kneissl1, G. Michael1, S. van Gasselt1; 1Planetary Science and Remote Sensing Group, Institute for Geological Sciences, Freie Universitaet Berlin, Malteserstr. 74100, 12249 Berlin, Germany; 2Planetary Science Institute, 1700 E. Ft. Lowell Rd., Suite 106, Tucson, AZ 85719, USA Introduction: Being in orbit at Mars since 2004, the High Resolution Stereo Camera (HRSC) [1, 2] has obtained nearly complete global coverage allowing the construction of full-resolution image mosaics on a global scale. The strong elliptical and highly irregular orbit of the spacecraft, which often results in large variations of illumination and atmospheric conditions between adjacent images, turns the brightness correction into a major challenge. Therefore a photometric correction is required in addition to the standard radiometric correction. In [3], a first-order correction for varying illumination conditions and resulting brightness variations assuming ideal diffusely (Lambertian) reflecting behaviour of the surface is described. This simple but robust correction method does not account for bi-directional influences of ground properties. Now we present an enhanced photometric correction based on the Hapke photometric model [4] and compare it with the Lambertian correction. In order to achieve homogenous image products ready for mosaicking, we derive one set of model parameters for each quadrangle and apply the correction to all the images of the quadrangle with the same set of parameters. Hapke modeling: We choose the MC-10E quadrangle for the example model area to directly compare it with the results of the Lambertian correction from [3]. We exclude 13 out of 166 images with visibly high atmospheric contribution from the modeling process. For the remaining set of images for all five panchromatic channels of the camera, the incidence, emission and phase angles are calculated by the use of an image-to-ground function for each channel using the VICAR framework [5] and the SPICE [6] library. The images are binned to a spatial sampling of 200 m per pixel. In order to avoid over-weighting of uneven dense data distribution due to the specific camera geometry the data is binned also in geometry space (i, e, a) with 5◦ bins. To avoid the limitations of photometric models at extreme scattering geometries, we also discarded data points with i > 80◦ analogous to [7]. Figure 1 shows data plots for the geometric configurations used for the subsequent fitting. We choose the six parameter version of the original isotropic multiple scattering model [4] with a doubleterm Henyey-Greenstein (HG2) function for our modeling experiments. The sparse coverage and minor quality at low phase angles does not let us expect a good representation of the opposition effect parameters in the modeling results. Due to the limited coverage of the emission angle (caused by the fixed mounting of the five panchromatic channels on the camera platform) the roughness parameter may not be well constrained either. Still, the 10 20 30 40 50 60 70 80 Incidence Angle [deg] 0.00 0.05 0.10 0.15 0.20 0.25 0.30 0.35 I/ F0 5 10 15 20 25 30 35 40 45 Emission Angle [deg] 0.00 0.05 0.10 0.15 0.20 0.25 0.30 0.35 I/ F0 20 40 60 80 100 Phase Angle [deg] 0.00 0.05 0.10 0.15 0.20 0.25 0.30 0.35 I/ FFigure 1: Geometric configurations of the extracted image data. phase angle coverage of up to 100 degrees should enable the modeling of the forward and the backward scattering lobe of the phase function. The fitting process is based on the LevenbergMarquardt technique implemented in Python [8]. The implementation of the Hapke formulas are taken from [7] in a version ported from IDL to Python. We perform the least-square fit with at least 100 randomly generated initial parameter sets for each filter to ensure the model converges to the true global minimum. All parameters are set free. As expected, it turns out that the roughness and oppositon parameters can not be well constrained. For the remaining three parameters, we find well-constrained values of 0.83 for the single scattering albedo (ω), 0.63 for the asymmetry parameter (b) and 0.97 for the backscattering fraction (c) of the HG2 phase function (best fit with a mean error of about 10%, cf. Figure 2). Results: The complete set of images are corrected with the Hapke model and then mosaicked together. The resulting mosaic is compared to the Lambertian correction in Fig. 3. From the visual inspection, it is not clear if the Hapke correction provides a significant improvement   20.05 0.10 0.15 0.20 0.25 0.30 0.35 Measured I/F 0.05 0.10 0.15 0.20 0.25 0.30 0.35 La mb ert -m od ele d I /F a) 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 Measured I/F 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 Ha pke -m od ele d I /F b) Figure 2: Measured I/F vs. modeled I/F, for a) the Lambert model and b) the Hapke model. over the whole extent of the mosaic. In areas, where the Lambertian corrections seems to "overcorrect" the images (resulting in brighter images), the Hapke correction appears to be more realistic. With regards to the complexity and stability of the two correction methods, the Lambertian correction remains the better candidate for current mosaicking efforts [9]. Acknowledgements: This work is supported by the German Space Agency (DLR Bonn), grant 50 QM 1301 (HRSC on Mars Express), on behalf of the German Federal Ministry for Economic Affairs and Energy. References: [1] G. Neukum et al., ESA SP 1240 (2004), 17-35. [2] R. Jaumann et al., PSS 55 (2007), 928-952. [3] S.H.G. Walter et al., LPSC 46, 2015, #1434. [4] B. Hapke, 2nd ed., Cambridge University Press, 2012. [5] URL: wwwmipl.jpl.nasa.gov/external/vicar.html. [6] C. H. Acton, PSS 44 (1996), 65-70. [7] J.-Y. Li et al., Icarus 226.2 (2013), 12521274. [8] URL: https : / /github.com/segasai /astrolibpy/ tree / master/mpfit (visited on 01/06/2016). [9] G.G. Michael et al., PSS (2015), accepted. a) Lambert-corrected reflectance mosaic b) Hapke-corrected reflectance mosaic Figure 3: Mosaicking results from the example region (MC10E half-quadrangle, Lunae Palus region). a) Lambertcorrected mosaic. b): Hapke-corrected mosaic  www-mipl.jpl.nasa.gov/external/vicar.html www-mipl.jpl.nasa.gov/external/vicar.html https://github.com/segasai/astrolibpy/tree/master/mpfit https://github.com/segasai/astrolibpy/tree/master/mpfit