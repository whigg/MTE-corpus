2464.PDF
Figure  1. Errors  introduced  by  baseline  correction.  Tenbaselines  (colored  lines)  were  fit  to  a  hanksite  spectrum(black  line)  using  the  Asymmetric  Least  Squares  (ALS)baseline  correction  algorithm  [3],  varying  the  smoothnessparameter λ on a log scale between 104 and 108 as suggestedby  the  authors.  Choice  of  the  best  value  for  λ  is  largelysubjective, and may require quality trade- offs: the low valuesof λ in blue clearly overfit the peaks on the left of the figure,but do a better job of modeling the baseline on the right half.Large values of λ (in red) preserve the peaks but often forcethe baseline above the original spectrum.BASELINE REMOVAL IN RAMAN SPECTROSCOPY: OPTIMIZATION TECHNIQUES. C. Carey1, M. D.Dyar2, T. F. Boucher1, S. Giguere1, C. M. Hoff3, L. B. Breitenfeld2, M. Parente4, T. J. Tague, Jr.5, P. Wang5, and S.Mahadevan1. 1School of Computer Science, Univ. of Massachusetts, Amherst, MA 01003, (ccarey@cs.umass.edu),2Mount Holyoke College, Dept. of Astronomy, South Hadley, MA 01075, 3dept. of Earth &Environmental Sci.,Rensselaer Polytechnic Inst., Troy, NY 12180, 4Dept. Electrical & Computer Engineering, Univ. of Massachusetts,Amherst MA 01003, 5Bruker Optics, Inc., 19 Fortune Dr., Billerica, MA 01821.Introduction: The  imminent  use  of  Ramanspectroscopy  for  planetary  exploration  on  Mars(Exomars,  Mars  2020) and other  bodies  (e.g.,  VenusRoadmap)  requires  an  infusion  of  work  intodevelopment  of  appropriate  databases  and  software.Successful  use  of  Raman on  extraterrestrial  surfaceswill  require  expansion  of  existing  mineral  databasesand a dramatic improvement  in  accuracy of  existingtools for mineral identification [1]. Our research groupis addressing these issues on multiple fronts, includingdevelopment work on optimizing software for mineralfingerprinting  with  Raman  spectroscopy  [2].  Thisreport  focuses on a a problem common to nearly alltypes of spectroscopy: baseline or continuum removal,in which some portion of a signal that is not necessaryto the features  of  interest  must  be removed.  Manualbaseline  removal  is  unprincipled  and  may  producevariable results. Many automated techniques have been proposed tosubtract  baselines  from  spectra,  each  with  tunableparameters that may be set to refine the quality of theremoved  baseline.  In  practice,  it  is  common  toempirically  find  parameters  that  produce  reasonableresults on a small set of spectra, then use that setting toprocess the remaining samples in the spectral library.As  no  baseline  correction  algorithm  is  perfect  andusers  cannot  find  perfect  parameter  settings  for  alldata,  continuum  removal  typically  introducessystematic error to subsequent processing (Figure 1).In  this  project,  we  evaluate  the  effects  of  sixdifferent  baseline  removal  techniques  on  Ramanspectra of minerals to test their effect on subsequentmineral  identification  matching  routines.  We  alsointroduce an optimization method to automate baselineremoval for this application.Background: There  are  numerous  methods  forbaseline removal in the literature based on polynomial[4],  spline  [5],  LOESS  [6],  and  Whittaker  [7]techniques.  In  this  project,  we  are  evaluating  threealgorithms  based  on  Whittaker  smoothing  (ALS,airPLS,  and  FABC),  two  that  include  iterativethresholding  based  on  mean  and  variance  (FABC,Dietrich),  and  two  that  involve  fitting  polynomialfunctions (Kajfosz-Kwiatek, Parente), as follows.1. Asymmetric  Least  Squares  (ALS)  [3]  finds  arough baseline with Whittaker smoothing, then lowersthe weight for points above the baseline, and iteratesuntil convergence is achieved. 2. Adaptive  Iteratively  Reweighted  PenalizedLeast  Squares  (airPLS) [8]  is  similar  to ALS exceptthat it uses the sum of differences between signal andbaseline to adjust weights intelligently.3. Fully  Automatic  Baseline  Correction  (FABC)[9] applies a continuous wavelet transform (CWT) toapproximate the first derivative of the signal.  It  thenfinds  "peak  bands"  by  selecting  all  bands  withintensities  greater  than  the  mean  +  k ×  standarddeviation  (where  k is  a  tuned  parameter),  a  processcalled  iterative  thresholding.  The  procedure  thenperforms  a  single  iteration  of  weighted  Whittakersmoothing  to  produce  a  baseline  followed  byrecalculation of the mean and standard deviation withany peak bands excluded.4. The method of Dietrich [10] is related to FABCin  that  it  performs  iterative  thresholding  on  the(squared) first derivative of the spectrum to find nonpeak  points.  Then,  rather  than  a  smoothing  step,  itreconstructs  the  baseline  for  all  bands  using  simple2464.pdf
46th Lunar and Planetary Science Conference (2015)
linear interpolation between non-peak bands.5. The  Kajfosz-Kwiatek  method,  which  uses  anon-polynomial approximation of background  [11], iscommonly  used  in  processing  x-ray  near-edgeabsorption spectra. It fits a set of polynomials to thesignal, both concave up and down, and then takes themaximum value over all polynomials as the baseline.6. Parente  [12,13]  developed  a  baseline  removaltechnique  for  remote-sensed  hyperspectral  data  fromthe visible and near-IR regions of the electromagneticspectrum. His novel algorithm casts baseline removalas a linear program that solves for the coefficients of aHermite  polynomial,  maximizing  the  size  of  thebaseline while  constraining the baseline to lie belowthe input signal across all bands.In  any  of  these  approaches,  the  difficulty  is  inchoosing  which  of  the  adjustable  parameters  isappropriate  for  any  given  spectrum;  this  is  usuallydone manually. We treat this choice as an optimizationproblem  in  which  baseline  parameters  are  adjusteduntil  the  removed baseline has  zero  predictive  valueand is not correlated with any compositional variable.Data:  For  this  project,  we  tested  six  baselinecorrection algorithms by applying them to a set of 184Raman  spectra  of  pure  mineral  samples  collected  atBruker Optics, Inc., in Billerica, MA. Once corrected,each  spectrum  was  matched  against  a  3950-samplesubset  of  the  RRUFF mineral  library.  The  matchingprocess  used  a  cosine  distance  metric  to  perform  knearest  neighbors classification. Granularity in matchaccuracy was provided by considering matches at eachlevel of the Dana classification hierarchy.The parameter for success of baseline removal wasaccuracy  of  correctly  matching  each  unknownspectrum  against  its  equivalent  in  the  RRUFFdatabase.  Each  mineral  name  was  matched  with  itsfour-part  (separated  by  periods)  Dana  classificationnumber in which the first number is mineral class, thesecond is mineral type, the third is the mineral group,and the fourth is the specific mineral species.Spectra  in  the  RRUFF library  are  provided  withbaseline correction already applied [14], so the targetset remained unchanged across all classification trials.This  experimental  setup  was  chosen  to  mimic  thecommon scenario of a preparing small set of unknownspectra to match against a well-curated library.Results:  Classification accuracy was predicted foreach  of  the  six  described  baseline  correctionalgorithms, as well as for a control setting where nobaselines  were  removed  before  matching.  Eachalgorithm  was  invoked  with  the  suggested  defaultparameters,  and no parameter tuning was performed.Table 1 shows classification accuracy at multiple Danalevels.  Scores  are  reported  as  the  percent  of  queryspectra with correct classification labels. For example,without baseline removal, only 8% of mineral specieswere  correctly  identified.  Best  results  were  obtainedwhen using the airPLS method of Zhang et al. [6]. Table 1. Classification Accuracy at Different Dana Levels Class Type Group SpeciesControl 17.39 9.24 9.24 8.15ALS 66.30 61.41 57.07 46.74airPLS 66.85 61.41 57.61 48.37Dietrich 52.72 47.28 46.2 39.67FABC 60.87 56.52 54.89 45.65Kajfosz-Kwiatek 65.22 60.33 55.43 45.11Parente 52.17 47.83 46.74 37.5Discussion: These  preliminary  results  alreadydemonstrate  important  conclusions.  Although Ramanmatching performed with the CrystalSleuth matchingsoftware provided on the RRUFF site does not use anybaseline  correction,  our  state-of-the-art  automaticbaseline algorithms yield much better performance. Ofthe  models  tested  so  far,  those  based  on  Whittakersmoothing  (ALS,  airPLS,  FABC) tend  to  work  welleven  without  tuning.  Finally,  there  is  room  forimprovement  in  mineral  identification software  fromRaman  spectroscopy.  Table  1  shows  that  correctmineral species identifications are obtained < 50% ofthe time, even with pure mineral spectra (confirmed byx-ray  diffraction)  and  high-quality  baseline  removal.Work  on  database  development  and  softwareimprovement  will  be  needed  before  Ramanspectroscopy  can  be  usefully  employed  on  remoteplanetary surfaces. Our group is working not only to acquire new datato supplement RRUFF but to introduce new algorithmsfor both baseline removal  and mineral  identification.Work  is  in  progress  to  develop  better  methods  forautomatic parameter tuning given limited data. Acknowledgments:  This  research  was  supported  byNSF grants CHE-1306133 and CHE-1307179 as well as bythe RIS4E node of NASA SSERVI.References: [1]  Carey  C.  et  al.  (2015)  J.  RamanSpectrosc.,  in  review.  [2]  Carey  C.  (2014)  Geo-Raman  8,Abstract  #5053.  [3]  Eilers  P.  H.  C.  and Boelens H.  F.  M.(2005)  Baseline  correction  with  asymmetric  least  squaressmoothing.  Leiden  Univ.  Medical  Centre  Report.http://www.science.uva.nl/~hboelens/.  [4] Gan  F.  et  al.(2006) Chemom. Intell. Lab. Syst. 82, 59–65. [5] de Boor C.(1978) A Practical Guide to Splines. Springer, New York. [6]Ruckstuhl  A.  F.  et  al.  (2001)  J.  Quant.  Spectrosc.  Radiat.Transf., 68, 179–193 [7] Eilers P. H. C. (2004) Anal. Chem.,76,  404–411.  [8]  Zhang Z.-M.  et  al.  (2010)  Analyst,  135,1138-1146. [9] Cobas J. C. et al. (2006) J. Mag. Reson., 183,145-151. [10] Dietrich W. et al. (1991) J. Mag. Reson., 91, 111. [11] Kajfosz J. and Kwiatek W. M. (1987) Nucl. Instrum.Methods Phys. Res., 22, 78-81. [12] Parente M. (2008) LPSCXXXIX, Abstract #2528. [13] Parente M. (2010) Ph.D. thesis,Stanford Univ. [14] http://RRUFF.info/. 2464.pdf
46th Lunar and Planetary Science Conference (2015)
