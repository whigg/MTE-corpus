 TOWARDS  AUTOMATIC  EXPLORATORY  MINERALOGICAL  MAPPING  OF  CRISM  IMAGERY USING SUMMARY PRODUCT SIGNATURES.  E. J. Allender1 and T. F. Stepinski1,  1Space Informatics Lab, University of Cincinnati, Cincinnati, OH, 45221-0131, allendej@mail.uc.edu. Introduction:  Hyperspectral images taken by the Compact  Reconnaissance  Imaging  Spectrometer  for Mars  (CRISM)  are  currently  the  best  source  of information  on  the  mineralogy  of  Martian  surfaces. When  combined  with  high  resolution  panchromatic images  and/or  HiRISE-derived  digital  elevation models they provide the most complete information on past and present processes shaping the Martian surface. In  particular,  they  have  provided  and  continue  to provide insight on the history of  water  on Mars [1]. However, working with CRISM images is challenging due to the sheer volume of data a hyperspectral image contains. We  are  developing  a  novel  method  for unsupervised  mineralogical  mapping  of  CRISM imagery  which  can  process  multiple  images automatically using a single  processing pipeline.  We envision  this  method  as  an  exploratory  tool  which, when  applied  to  a  large  collection  of  images,  will automatically  map  potential  locations  of  rare  and interesting  mineral  deposits  in  each  image  without input from an analyst.  The purpose is  to comb large archives  of  CRISM  images,  inspect  them  for  the existence  of  interesting  deposits,  flag  these  deposits and their 'interesting' components, and return annotated mineralogical maps of the images for manual, in-depth analysis. To  achieve  this  functionality  we  integrated  two core  novel  technologies.  First,  instead  of  using  a spectral function or a triplet of summary products as is currently standard  [2], we use vectors of all  popular summary  products  as  the  spectral  signature  of  an image.  This  representation  does  not  restrict  which minerals  can  be  identified  while  at  the  same  time offering  instant  interpretation  of  the  content  of identified  deposits.  Second,  we  use  the  rare  class discovery  algorithm  DEMUD  [3] to  identify mineralogical  classes  in  each  image.  This  has  the advantage  of  identifying  mineralogical  "outliers," deposits  that  stand  out  from  the  scientifically uninteresting background. Data:  We test the feasibility of our method using 20  previously  manually  studied  FRT  images [1,4,5,6,7,8] downloaded from the PDS Mars Orbital Data  Explorer.  They  cover  a  range  of  features including  mounds,  volcanoes,  gullies  and  stratified deposits. Method:  The processing pipeline for our method has four main components: (1) image input and preprocessing, (2) image normalization and segmentation, (3)  clustering  with  DEMUD,  and  (4)  mapping  and validation.  The  pipeline  is  implemented  in  the  bash environment, and calls scripts enabling functionality in ENVI  IDL,  GRASS,  R  and  C  throughout  each processing stage. Image input and pre-processing:  Batch processing is used to complete this step for the set of images with maximum efficiency. The pipeline makes use of ENVI CAT procedures  within  IDL to  perform photometric and atmospheric correction with artifact removal, and generate  hyperspectral  and  multispectral  summary products. Image normalization and segmentation: Summary products are read into the R environment where they are  treated  as  raster  maps  in  which  each  pixel contained  a  vector  of  summary  product  values.  The range of each vector component is normalized to the range  between  0-1  so  that  the  degree  of  similarity between summary product signatures can be assessed in this way, whether band depth or reflectance based, each component of the signature vector contributes the same  weight  to  the  calculation.  A  graph-based segmentation algorithm [9]  is  used  to  (over)segment each  raster  in  order  to  reduce  data  volume  and  to reduce  noise  through  spatial  smoothing.  Remaining calculations  are  performed  on  resulting  segments called superpixels. Clustering  with  DEMUD: The  superpixels  are input into the rare-class detection algorithm DEMUD (with k=2 preserved eigenvectors) implemented in R. DEMUD is an iterative algorithm designed to identify a  number  of  superpixels  which  are  as  dissimilar  as possible  from  each  other  and  from  the  rest  of  the superpixels.  Thus, the first  several  iterations identify superpixels  representing  different  interesting mineralogical deposits.  In order to estimate how many mineral classes are present within an image we use the value  of  the  reconstruction  error  (Rx)  between  the DEMUD  model  at  a  given  iteration  and  each observation; the larger the Rx value, the more unique the  mineralogical  deposit  identified  in  this  iteration (Figure 1). The superpixels selected with values of Rx above  a  threshold  are  chosen  as  representatives  of 'interesting'  mineral  classes  within  an  image.  This selection is one of the two elements of computational pipeline that is still performed manually in the present version  of  our  software.  The  Nearest  Neighbor algorithm is used to assign all superpixels (and thus the  pixels in an image) a mineralogical class on the basis of  minimum  Euclidean  distance  to  representative superpixels.  Superpixels  too  distant  from  all representatives are left unclassified. Mapping  and  interpretation:   Resultant  maps  of mineralogical  classes  are  automatically  produced. Along with each map, the pipeline produces a series of graphs  detailing  the  difference  between  each  class signature and the mean signature of the image - which is considered the 'background' signature. These graphs are used to make an interpretation of each class. This interpretation is the second element of pipeline that is currently  performed  manually  (although  it  is  rather straightforward);  future  work  will  automate  the  two manual elements of the present implementation. Results: In the majority of the 20 surveyed images the mineralogical classes discovered automatically by our method correspond to deposits found by means of manual analysis. In some cases, such as images from [4], the  striping  noise  was  too  great  for  meaningful classes to be discovered.  In images with a lower level of  noise,  for  example  those  from [5,6],  our  method discovered  the  presence  of  additional  mineralogical classes not found using the traditional tricolor browse products. Conclusion: Application of our method to a small survey of 20 previously manually studied FRT images reveals that our concept of using the combination of the summary product  signature representation format with the DEMUD rare-class detection algorithm works as expected and offers a feasible way to conduct larger exploratory surveys of CRISM images.  Improved preprocessing  and  noise  reduction  procedures  will  be required for  our method is  to  be  applied to  a  larger range of  images.  Algorithms for  the selection of  the number of classes and for their interpretation need to be  implemented  in  order  to  make  our  method  fully automatic. Supplementary Material:  The full list of 20 FRT images and the mineralogical  maps produced by our method  for  this  survey  are  available  at http://sil.uc.edu/pdfFiles/lpsc2014Supplement.zip. References: [1]  Ehlmann  B.L.  (2011),  Nature, 479(7371) 53-60, [2] Pelkey S.M. et al. (2007), JGR, 112, E08S14, [3] Wagstaff K.L. (2013), Proc. XXVII Conf. Artif. Int., [4] Ackiss S. E. and Wray J.J (2014) Icarus,  243, 311-324.  [5]  Bishop  J.L.  et  al.  (2009) JGR, 114, E00D09. [6] Lichtenberg K.A. et al. (2010) JGR,  115,  E00D17.  [7]  Mustard  J.F.  et  al.  (2008) Nature,  454,  305-309, [8]  Noe  Dobrea  E.Z.  (2010), JGR, 115, E00D19, [9] Felzenszwalb P.F. et al. (2004), Int. Jour. CompVis, 59(2), 167-181. 