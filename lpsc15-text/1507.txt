1507.PDF
Lunaserv WMS Software Enhancements N. M. Estes, C. D. Hanger, A. Ramaswamy, A. Johnson, E. BowmanCisneros, M. S. Robinson, School of Earth and Space Exploration, Arizona State University, nme@ser.asu.eduIntroduction:  The Lunar Reconnaissance OrbiterCamera  (LROC)  Science  Operations  Center  (SOC)created  the  Lunaserv  Web  Map  Service  (WMS)software  to  solve  key  planetary  data  issues  withpreviously existing WMS packages [1]. Since the firstrelease  in  2009,  Lunaserv  has  evolved  to  includeenhanced  searching,  filtering,  and  visualizationcapabilities.  Recent  improvements  include  annotatedpoint  layers,  strategic  multi-threading/multiprocessing,  dynamic  map  start  coordinates,  periodicrefreshing, and new vector layer filtering capabilities.Layer Updates:  Previous versions of the vectorlayer allowed for either annotations or points, but theseare now combined to allow for annotated points. Thesame padding rules apply to annotated points, but allpoints  display even if the points are too crowded todisplay the annotation (Fig. 1). The point capability ofLunaserv's vector layers was further enhanced to allowrendering icons instead of simple points. This featurealso allows specifying the icon's "hot spot" so that thecorrect point of the icon renders on the point of interest(Figs. 2,3). The "Where is LRO" page on the LROCweb site now uses the new annotated points to showLRO's  position  with  time,  altitude,  andlatitude/longitude information [2].Lunaserv Global Explorer (LGE), the OpenLayersbased  WMS  client  software,  now  has  a  per-layerconfiguration for reloading frequently-changing layers.This function will reload the layer, bypassing the webbrowser's cache, to rapidly display changing data suchas illumination or position at regular intervals.LGE  was  also  enhanced  to  allow  specifying  astarting map center location other than 0°,0° on a perbody  basis.  The  starting  location  is  either  a  staticFigure 3: Apollo 15 landing site rendered by Lunaserv with a cross-hair indicating the lander position.Figure 2: Apollo 15 landing site rendered by Lunaserv with a pin indicating the lander position.Figure 1: Lunar nomenclature rendered as annotated points showing how all points are rendered but labels are evaluated in priority order and only show if they fitwithin the padding rules;. The label padding for this image was set to 10 pixels.1507.pdf
46th Lunar and Planetary Science Conference (2015)
latitude and longitude, or LGE can load a coordinatefrom a JSON web service [3]. The web service couldreturn  the  approximate  latitude  and  longitude  of  theuser based on their IP address, or the web service couldprovide  coordinates  dynamically  based  on  otherinformation.Software  Updates:  There  were  compilationupdates for newer compiler versions in the Lunaservrendering engine.  The primary development platformfor Lunaserv is Ubuntu Linux [4] which comes with anupdated version of the GCC compiler.There were also two significant improvements tothe  rendering  engine  performance  when  processinglarge  tiled  datasets  such as  the  681 giga-pixel  NACNorth Pole Mosaic [5]. The first of these two changesintroduces multi-threading while loading the pyramidalTIFF tiles and determining which resolution to use forrendering. By processing many tiles at once, this stepcompletes faster, speeding up map tile rendering. Thesecond performance enhancement breaks up large listsof tiles into multiple sets, ordered by layer priority, andthen  renders  those  tile  sets  individually  beforecompositing the final layer.Keeping  up  with  increasingly  higher-resolutionproducts  requires  further  performance enhancements.One such performance strategy under consideration isto  provide  caching  of  pixel  scale  and  bounding boxmeta-data to speed up tile selection.Vector Layer Filtering Improvements: The mostrecent  release of  Lunaserv includes two vector  layersearching  and  filtering  improvements.  The  firstexpansion  is  to  the  WMS  "GetFeatureInfo"  requesttype which now allows a bounding box to search forfeatures  in  an  area  instead  of  at  a  point.  This  newsearch turns the bounding box in map coordinates intoa  polygon  in  latitude  and  longitude  coordinates  forsearching  against  a  database.  This  new  searchcapability  falls  back  gracefully  to  a  point  search forWMS clients  or  WMS layers  that  do not  handle theenhanced search. The second enhancement allows forgenerating  more  complex  SQL clauses  for  databasedriven layers. The previous filtering capability allows atemplate  with  a  user-provided  parameter  to  filterdatabase  results  for  rendering  on  a  map.  The  newfunctionality allows for a file containing Ruby code toprocess the user-provided parameter to construct morecomplex  database  expressions.  For  example,  aparameter with JSON encoded values could be passedto Lunaserv where user-provided code could turn theJSON values into a custom database search.Vector Layer Color Coding: When adding vectorlayers to Lunaserv, it becomes increasingly difficult tochoose  a  new  color  with  sufficient  contrast  whencombined  with  other  vector  layers  on  any  of  theavailable  base  maps.  The  challenge  is  greater  stillwhen considering  accessibility  with various types  ofcolor-blindness,  and  that  the  WMS  user  is  free  tocombine  layers  in  arbitrary  ways.  After  researchingvarious color schemes, color contrast algorithms, andexisting color categorization work, the Lunaserv teamchose Kenneth Kelly's  list  of  twenty-two contrastingcolors [7] (Fig. 4). The Lunaserv team plans to presentadditional  details  on  the  color  coding  work  at  thePlanetary Data Workshop June 2015 in Flagstaff, AZ.Usage since March 2014: Lunaserv usage in 2014was approximately four times higher than in 2013 [6].While  most  usage  comes  from  users  of  LGE,  wecontinue to see traffic from QGIS and ArcGIS users aswell. In May 2014, Lunaserv saw over 1.5 million hitsfrom the osgEarth application from a user in the stateof  Washington.  While  the  number  of  independentLunaserv deployments is unknown, the current versionof  the  Lunaserv  installation  package  has  beendownloaded 952 times.References: [1] Estes, N.M.; et. al.; (2013), http://www.lpi.usra.edu/meetings/lpsc2013/pdf
/2609.pdf
  [2]Where  is  LRO,  http://  lroc.sese.asu.edu/  about/whereislro  [3]  freegeoip.net,  https://freegeoip.net/ [4]Ubuntu  Linux,  http://www.ubuntu.com/ [5]  681Gigapixels!,  http://  lroc  .sese  .asu  .edu/  posts/  738 [6]Estes,  N.M.;  et  al.  (2014):,  http://www.hou.usra.edu/meetings/lpsc2014/pdf
/2180.pdf
 [7] Kelly, Kenneth L.,Color Engineering, 3:26-27, 1965. [8] Scholten, F., et.al.  (2012),  JGR,  117,  E00H17,doi:10.1029/2011JE003926.Figure 4: WAC GLD 100 color Shaded Relief [8] with four RDR vector layers showing the resulting color selection.1507.pdf
46th Lunar and Planetary Science Conference (2015)
