2186.PDF
ONLINE SPECTRAL FIT TOOL (OSFT) FOR ANALYZING REFLECTANCE SPECTRA.  A. Penttilä1, T. Kohout1, and K. Muinonen1,2. 1Department of Physics, P.O.Box 64, 00014 University of Helsinki, Finland (Antti.I.Penttila@helsinki.fi). 2Finnish Geospatial Research Institute, P.O.Box 15, 02431 Masala, Finland.   We present an algorithm and its implementation for fitting continuum and absorption bands to reflectance spectra. The intended usage of this tool is the modeling of reflectance of mineral samples in ultraviolet/visual/near-infrared wavelengths. The implementation is done completely in Javascript and HTML, and will run in any modern web browser without requiring external libraries to be installed. Introduction:  The Online Spectral Fit Tool (OSFT) [1] was developed to our own needs in analyzing VIS-NIR spectral behavior of asteroids and meteorites. Our approach is similar to the Modified Gaussian Model (MGM) –software by Sunshine et al. [2,3], but with certain differences in the model and in the implementation. The MGM software has been ported to MATLAB, FORTRAN, and IDL programming languages. We extended the applicability even further by implementing our software in Javascript/HTML so that it can be used through web browser. The OSFT runs in the client-side (in users own computer/browser), and is selfconsistent needing no plug-ins to be installed. The OSFT uses two public third-party Javascript libraries [4,5] which are included in the software. We follow the approach of the MGM in the sense that we use no pre-determined spectral data, but fit the spectra using mathematical continuum model and analytical functions for absorption bands. The OSFT does not relate the fit directly to specific substances or known spectral elements, but gives statistics describing the behavior of the continuum and the absorption bands. There are some semi-physical assumptions behind the model in the MGM. However, some of them are quite approximate when it comes to reflectance spectra of solid mineral samples. With the Central Limit Theorem, one can vaguely justify the Gaussian distribution as a model for an absorption band arising from several overlapping effects. On the other hand, also the Lorenzian band shape (i.e., Cauchy distribution) is used. Sunshine et al. [2] justify using the modified Gaussian model by crystal field theory and empirical tests. We feel that any of the abovementioned band shapes are not, strictly speaking, derived directly from physical principles applicable to mineral reflectance. Thus, we choose to use band model that seems to fit best to our data (see later). We also fit the data directly in the wavelength-reflectance scale. The use of energy instead of wavelength seems to be based on the derivation of absorption bands around specific energies. If we admit that the band shape function cannot be derived accurately from the first principles with mineral spectra, we may as well use the wavelength and not the energy as the variable. The use of the logarithm of reflectance is justified with the Beer-Lambert law in [2]. We note that the light scattering mechanisms behind the observed reflectance of solid mineral samples are far more complex than the Beer-Lambert law, therefore we see no necessity of using logarithm of reflectance. In conclusion, we admit that our model choices are purely empirical and mathematical, and that we are missing a direct first-principles physical model. Models based on physical approximations might work well, but at the moment the model can only be judged on its applicability to accurately fit the data with a reasonably small number of parameters. OSFT Model Formulation:  Our model for UVVIS-NIR spectra is based on continuum with superimposed absorption bands. The model parameters are fitted using constrained non-linear optimization. Absorption bands.  We use the shape of the Gamma distribution for the absorption bands. In our tests, the Gamma shape seems to fit the data better than the Gaussian, Lorenzian or modified Gaussian shape. The Gamma distribution is more peaked than the Gaussian, and our data seem to favor such shape. The gamma distribution is defined for positive values only, which support its use with (positive) wavelengths. If the expected value μ of the Gamma distribution is far from zero (μ/σ>>0), the distribution is almost symmetric. We use an alternative parameterization of the Gamma distribution where μ and the standard deviation σ are the parameters of the distribution. The probability density function f is 𝑓(𝑥; 𝜇, 𝜎) =1𝑥 Γ(𝜇2𝜎2) 𝑒−𝜇 𝑥𝜎2  (𝜎2𝜇 𝑥)−𝜇2𝜎2 where Γ is the Gamma function and x>0. The actual absorption peak p in the model is the Gamma distribution that is first normalized to have maximum value of 1*, and then multiplied by the peak strength parameter c:                                                            *approximately. Because the Gamma distribution is not strictly symmetric, f(μ;μ,σ) can be slightly smaller than the maximum value of the distribution. 2186.pdf
46th Lunar and Planetary Science Conference (2015)
𝑝(𝑥; 𝜇, 𝜎, 𝑐) =𝑐𝑓(𝜇; 𝜇, 𝜎) 𝑓(𝑥; 𝜇, 𝜎) The area A of the band can be derived analytically: 𝐴(𝜇, 𝜎, 𝑐) = ∫ 𝑝(𝑥; 𝜇, 𝜎, 𝑐)𝑑𝑥∞0= 𝑐 𝑒𝜇2𝜎2  𝜇 (𝜇𝜎)−2 𝜇2𝜎2  Γ(𝜇2𝜎2) while the full-width-at-half-max (FWHM) w of the peak needs to be solved numerically by finding x’s so that 𝑤(𝜇, 𝜎) = 𝑥𝑓(𝑥;𝜇,𝜎)=1 2⁄  ⋀ 𝑥>𝜇 −  𝑥𝑓(𝑥;𝜇,𝜎)=1 2⁄  ⋀ 𝑥<𝜇 Continuum.  We wanted the continuum model to be more flexible than first-order polynomials. For this reason we chose cubic splines as the basis of the continuum. The continuum is modeled as the linear combination of five B-spline basis functions of third degree with knots in the range from smallest wavelength λmin to largest wavelength λmax in the data. The coefficients bi of the linear combination are to be fitted. Fit.  The final fit g(λ) to data is: 𝑔(𝜆) = ∑ 𝑏𝑖𝑠𝑖(𝜆) −  ∑ 𝑝(𝜆; 𝜇𝑖 , 𝜎𝑖 , 𝑐𝑖)𝑛𝑖=14𝑖=0 where si are the ith B-splines of degree 3, λ is the wavelength, n is the number of absorption peaks, and μi,σi,ci are the mean, standard deviation, and depth for peak i. Optimization.  The function g(λ) is fitted to the data using constrained non-linear optimization. The sum-ofsquared-errors (SSE) between data and model is minimized. Constraints need to be set for the band parameters. All standard deviations and depth parameters σi,ci≥0. The mean parameters need to be ordered, λmin≤μ1≤…≤μn≤λmax. Actually, in addition to minimizing SSE we also introduce two other penalizations with small weights. These penalizations are related to the continuum being smooth and the bands to extend only to the area of absorption and not to continuum. Usage:  The beta version of the OSFT is already online and publically available [1]. The user can upload a text-file of wavelength-reflectance pairs. The data is shown graphically, and user can select the number of absorption bands. Initial parameter guesses need to be given for band centers, deviations and depths. With initial values for bands, the continuum is fitted using the linear least-squares fit, and the initial fit is displayed with the data. Once the initial fit is in the right neighborhood, the algorithm will do the actual non-linear fit for the band and continuum parameters together. When completed, the software can compute fit statistics, i.e., band locations, deviations, depths, FWHM-values and band areas, together with the slope and albedo parameters. At this point, the data can also be normalized at a given wavelength. We prefer to normalize only after the fitting, since we rather normalize with the value from the fitted continuum than with a single measured reflectance value. A single measured value can contain errors which will affect the slope and band depths, while the fitted continuum is ‘an average’ and thus have smaller errors. Fig. 1 shows two examples of the fit produced by the OSFT. References:  [1] Penttilä A. and Kohout T. (2015) http://www.helsinki.fi/project/psr/OSFT/. [2] Sunshine J. M., Pieters C. M., and Pratt S F. (1990) JGR, 95, 6955–6966. [3] Sunshine J. M. et al. (1999) LPSC 30. [4] Gustafsson A. (2012) Cobyla2 port to Javascript, http://code.google.com/p/jscobyla/. [5] Flotr2 Canvas graphing library (2014) http://www.humblesoftware .com/flotr2/.  Figure 1: On the left, the OSFT fit with two absorption bands for orthopyroxene including nanophase Fe0. On the right, the OSFT fit with three overlapping absorption bands for olivine including nanophase Fe0. In both subfigures the blue line is the data, yellow the fit, red the continuum part, and green the absorption peaks. 2186.pdf
46th Lunar and Planetary Science Conference (2015)
