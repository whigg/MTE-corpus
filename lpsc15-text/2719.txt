 LIGHT TIME AND STELLAR ABERRATION CORRECTIONS IN ISIS, STATUS AND LOOKING AHEAD.  C. E. Isbell 1, K.J. Becker 1, L. Kestay 1, S. Sides 1, R.L. Kirk 1, B.A. Archinal 1, and J.A. Anderson 1,2 , 1 Astrogeology Science Center, U.S. Geological Survey, 2255 N. Gemini Drive, Flagstaff, Arizona 86001 (cisbell@usgs.gov). 2 Retired.  Introduction:  Light time and stellar aberration (abbreviated throughout as "light time") corrections may be important when considering both spacecraft (observer) and planetary body (target) location during cartographic processing of data collected by planetary spacecraft. The USGS Integrated Software for Imagers and Spectrometers (ISIS) [1] utilizes rigorous camera models and the Navigation and Ancillary Information Facility (NAIF) SPICE toolkit [2-3] for these calculations. Light time correction should be applied to apparent target position relative to the observer in order to produce the most accurate cartographic products. Previous work details how ISIS utilizes the SPICE toolkit and analyzes the effect of the different light time correction options' ability to locate well-characterized lunar control points in LROC images [4]. Here we provide a broader summary of light time correction in ISIS with an emphasis on practical considerations utilizing representative planetary data sets to describe the usage of different light time correction modes in ISIS, consider relevant anomalies and implications where light time corrections were applied to legacy data, and recognize the additional analysis and developments needed to improve the light time correction provided by ISIS. Current and Previous ISIS implementation:  ISIS developers describe, and analyze the impact of, a flawed implementation of light time correction in early versions of ISIS (3.4.1 and prior) where the observer (rather than target) position was shifted while the target (rather than the observer) was held fixed [4].  Furthermore, correction calculations were originally based on distance to target center, rather than distance to the surface. The latter can "overcorrect" for light time, degrading rather than improving the cartographic precision of the ISIS products [4]. ISIS (3.4.2+) now allows for swapping (i.e., correcting) the target/observer reference frame, applying corrections based on distance to target surface, and disabling light time correction altogether. It is important to note that light time corrections are applied by default within ISIS, unless specified otherwise within the kernel parameters. Default functionality and means of invoking custom kernels are discussed further below. Correction considerations:  Multiple factors are at play in determining whether light time correction should be applied. These factors primarily include the relative velocity of the spacecraft and target, distance to target surface, and instrument spatial resolution. In addition, compute time requirements for calculations at the highest precision and accuracy may be prohibitive. The following table provides, for some representative data sets, estimates of target position offsets (i.e., light time corrections) based on calculations done to the target center (default ISIS implementation) and to surface (more correct implementation). Table 1. Correction offsets (meters) for representative orbital and flyby configurations. Content is simplified by reflecting nadir viewing with limited (yet common) single case range and resolution examples. Note corrections based on "to center" (red, ISIS default) as compared to "to surface" (green, more correct) calculations. In some cases, especially for low altitude spacecraft, considering light time for distance to target center (versus to surface) results in significant overcorrection (e.g. LROC and MDIS-close). In general, low altitude spacecraft (where the difference between the distance to the target surface and center are the largest) with high spatial resolution instrumentation are where the correct light time correction is most important. There are also situations where light time correction does not produce any meaningful improvement to the cartography and is thus an inefficient use of compute resources (e.g., Clementine data).  However, for high velocity flyby situations (e.g. Pluto, Enceladus), light time correction may be appropriate, with corrections of multiple pixels. A more comprehensive and inclusive analysis will be presented at the meeting. Invoking correction modes:  ISIS default functionality applies light time correction with observer position computed (fixed target) and considers distance Target Instrument Target Range (to center) (km) Correction to surface (m) Correction to center (m) Spatial Resolution (m/pxl) Moon LROC NAC 1787 0.28 10.16 0.50 Moon Clementine (UVVIS/NIR) 2137 1.01 5.38 100.00 Mars Viking 3896 5.90 45.98 40.00 Mars MRO (HiRISE) 3671 3.34 44.55 0.27 Mercury MESSENGER MDIS (close) 2640 1.94 25.55 5.00 Mercury MESSENGER MDIS (far) 17440 55.15 64.12 375.00 Pluto New Horizons LORRI (close) 11195 459.79 514.73 50.00 Enceladus Cassini (ISS) 25450 538.71 544.06 150.00   to target center (rather than to target surface). ISIS (3.4.2+) now allows for resetting parameters used for light time correction via instrument addendum kernels (IAKs). Details regarding use of software kernels in general are described within ISIS documentation and tutorials [1] but this use (light time correction) is not explained in the existing tutorials. Below we describe how to use IAKs to invoke various light time correction modes in ISIS. IAK parameters and options (three parameters): Default light time correction functionality is 'hard coded' within ISIS. However, if IAKs are installed, the following parameters can be changed from the default values. INS-nnnnnn_SWAP_OBSERVER_TARGET INS-nnnnnn_LIGHTTIME_CORRECTION INS-nnnnnn_LT_SURFACE_CORRECT Where "nnnnnn" is a five or six digit numerical NAIF instrument ID [5], with specific parameter options indicated below. *_SWAP_OBSERVER_TARGET = 'FALSE' *_SWAP_OBSERVER_TARGET = 'TRUE' Where 'FALSE' indicates Target fixed (ISIS default) and 'TRUE' indicates Observer fixed (more correct).  *_LIGHTTIME_CORRECTION = 'LT+S' *_LIGHTTIME_CORRECTION = 'NONE' *_LIGHTTIME_CORRECTION = '[NAIF values]' Where 'LT+S' indicates light time and stellar aberration correction (ISIS default), 'NONE' indicates disabling light time correction, with additional NAIF value options [5]. *_LT_SURFACE_CORRECT = 'FALSE' *_LT_SURFACE_CORRECT = 'TRUE' Where 'FALSE' indicates distance to target center calculation (ISIS default) and 'TRUE' indicates distance to target surface (more correct). IAKs utilizing these parameters are currently provided with ISIS for only LRO-LROC and MESSENGER-MDIS. The following describes ISIS IAK settings for those instruments. LRO-LROC NAC & WAC, with NACL (NAIF ID 85600) shown. Values are identical across NAC and WAC instruments. INS-85600_SWAP_OBSERVER_TARGET = TRUE' INS-85600_LIGHTTIME_CORRECTION = 'NONE' INS-85600_LT_SURFACE_CORRECT   = 'TRUE' Therefore (per 'NONE' value above), light time correction is currently disabled for LROC. This mode is imposed since "to center" calculations will result in sizable but incorrect offsets (see the Table 1 LROC entry) when map projecting an image while "to surface" calculations provide such small corrections that they are considered an inefficient use of computational resources. MESSENGER-MDIS NAC & WAC, with NAC (NAIF ID 236800) shown. Values are identical for both NAC and WAC. INS-236800_SWAP_OBSERVER_TARGET ='TRUE' INS-236800_LIGHTTIME_CORRECTION = 'LT+S' INS-236800_LT_SURFACE_CORRECT = 'FALSE' Additional required analysis and development:  Further analysis is required in a number of areas. For one, we intend to determine where light time "overcorrection" was applied during processing of recent and legacy datasets. Some legacy data sets (especially HiRISE) have implemented empirical corrections for inaccurate light time correction in ISIS within their camera model.  In such cases computing light time correction "more correctly" will degrade, rather than improve, the cartographic precision of ISIS products.   Also, as previously indicated [4], further analyses will be made in examining the wide range of instruments and targets (including diurnal aberration resulting for fast rotating bodies). Varying instrument types will be considered (e.g. pushbroom, framing, radar (two-way light time)). This is especially relevant as new instruments are developed and deployed. Comprehensive analysis is required even for a particular single instrument, especially for oblique viewing and where mission orbital configurations can vary widely throughout mapping and extended phases (e.g., Voyager flybys and Messenger elliptical orbits). Additionally, long term improvements to ISIS must be made in areas of efficiency (speed of execution) in implementing this fundamental (e.g. single pixel calculation) and higher complex functionality (e.g. pixel-bypixel computation, interpolation across pixels, etc.). Based on this analysis we will prioritize future ISIS development efforts. Equally importantly, we plan to provide further tutorials and documentation to allow users to most properly take advantage of the light time correction capabilities in ISIS.   References: [1] Keszthelyi et al. (2014) LPS XL, #1686; http://isis.astrogeology.usgs.gov/. [2] Anderson J. A. (2008) LPSC XXXIX, Abstract #2159. [3] Acton C. H. (1996) Planetary Space and Science, Vol. 44, No. 1, 65-70. [4] Anderson J. A. (2013) LPSC XLIV, Abstract #2318. [5] Bachman N.J. (2009) NAIF CSPICE Reference Manual, http://naif.jpl.nasa.gov/pub/naif/toolkit_docs/C/cspice/s pkez_c.html. 