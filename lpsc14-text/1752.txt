1752.PDF
ANALYTICAL MODEL AND SPECTRAL CORRECTION OF VIBRATION EFFECTS ON PFS FOURIER TRANSFORM SPECTROMETER. F. Schmidt1, I. Shatalina2, B. Saggin2, N. Gac3, M. Kowalski3 and M. Giuranna4, 1Univ Paris-Sud/CNRS, IDES, UMR8148, Orsay, F-91405, France (frederic.schmidt@u-psud fr), 2Dipartimento di Meccanica, Politecnico di Milano, Campus of Lecco, via Gaetano Previati 1/c, 23900, Lecco,  Italy, 3Laboratoire des Signaux et Systèmes (L2S), UMR8506 Univ Paris-Sud - CNRS – SUPELEC, SUPELEC, 3 rue Joliot Curie, Gif sur Yvette, F-91192, France; 4IFSI, via del Fosso del Cavaliere 100, 00133, Roma, Italy   Introduction: Since January 2004, the Planetary Fourier Spectrometer (PFS) [1] onboard Mars Express (MEx) is the instrument with the highest spectral resolution observing Mars from orbit. It permits studying the atmospheric structure, major and minor compounds. The present time version of the calibration [2,3] is limited by the effects of mechanical vibration [4], currently not corrected. We proposed here a new approach to correct for the vibrations based on semiblind deconvolution of the measurements. This new approach shows that a correction can be done efficiently with 85% reduction of the artifacts, in an equivalent manner to the stacking of 10 spectra. It may be applied on the complete PFS dataset, correcting the large-scale perturbation due to microvibrations for each spectrum independently. This approach is validated on actual PFS data of Short Wavelength Channel (SWC), perturbed by microvibrations. More generally, this work may apply to numerically “deshake” Fourier Transform Spectrometer (FTS), widely used in space experiments or in the laboratory.  Method: Using some mathematical reorganization and simplification, the analytical expression of mechanical vibration due to periodic misalignment and optical path errors can be written as a convolution products in complex form [5,6]:     To estimate the signal from Mars IMars, from the observed spectra IPFS , without knowing the kernel KPFS due to microvibration, we need to perform a blind deconvolution. Our approach is based on cost function that must be minimized [7]:    The first terms represent the data fit, the second the sparsity regularization and the third a smooth regularization. We proposed to minimize the function iteratively by estimating IMars, and KPFS. We use an initial guess of the Martian spectra as the first step and estimate KPFS with the sparsity regularization only. We then estimate IMars with smooth regularization only. The iterative loops between those two steps are performed until to reach convergence (see figure 1).    Figure 1: Scheme of the proposed iterative deconvolution algorithm   Results:  Figure 2 represents the results for the PFS spectra ORB0032 # 106 in the useful domain, not perturbed by the laser line (0 to 5000 cm-1). This spectrum is taken as an example due to its high level of perturbation. The artifacts, called “ghosts”, are pointed by arrows in the raw spectra (at the top). Ghosts features are significantly removed by 85% and the noise standard deviation is reduced from 0.17 to 0.07. To reach the same level of ghosts removal, a stacking of 10 spectra raw is required. Figure 3 represents the results in the laser line domain (5000 to 8330 cm-1), where the microvibrations artifact of the reference laser line occur. The laser line modulated through filter, aliasing and vibration kernel KPFS�(desired spectra)(noise)�(acquisition data)IMars IPFS(instrument)Figure 3: Modelisation of acquisition by the PFS instrumentThe assumption of a reduced wavenumber domain is valid in first approximation due to the sentitivity of the detector and the typical Martian signal, leadingto a misfit factor of x0.8 to x1.2 that is reasonable for this case. In addition,our strategy is to use blind deconvolution algorithm, without a priori shape ofthe spectra, in order to ensure the best fit any kind of spectra. This way, thewavenumber domain of significant signal has not to be defined explicitely.Including to our model an additive noise � which stands for the others sourcesof acquisition noise besides the mechanical vibrations and the error due to ourPFS modelisation by a convolution kernel KPFS , PFS spectra in signal domainas illustrated in Fig. 3, are obtained through:IPFS(σ) = IMars(σ) �KPFS(σ) + � . (5)2.1.2. Laser line domain (5000 to 8330 cm−1)Unfortunately, from the laser line domain it is not possible to realize an inversion to estimate KPFS because there is twice unknown variables in comparisonto known variable due to aliasing. Under strong hypothesis, it is possible toestimate an approximation of KˆapproxPFS [11]. Nevertheless, the recent analyticalformulation of the mechanical eﬀects on the laser line, allows us to compute theexact eﬀect of the mechanical vibration on the laser line, knowing the vibrationkernel KPFS (see complex expression in [11]). After the estimation of KPFS ,one simple test of coherence would be to compare the observed laser line ghostto the one predicted.6Figure 2: Model of acquisition by the PFS instrument2.2. InversionFrom the direct model of the PFS instrument described above, see Eq. (5),we propose here a semi-blind deconvolution method to solve the inverse problem:estimation of the desired spectra IMars from the PFS spectra IPFS although theconvolution kernel KPFS is unknown. We qualified our method as semi-blindbecause the only spectral a priori information is Iˆ0Mars, known ab initio. Wealso used two a priori information : IˆMars is smooth and KˆPFS is sparse. Thenotation Xˆ,means the estimation of quantity X. A classical approach consistsin introducing a cost function C whose minimum provides an estimation:IˆMars, KˆPFS = argminIMars,KPFSC(IMars,KPFS)= argminIMars,KPFS12�IPFS −KPFS � IMars�22 + λK�KPFS�1 +λMars2�D � IMars�22 .(6)Three terms appear in C1. A data fit term 12�IPFS − KPFS � IMars�22 that quantifies how well theestimated sources match the measured data. This term takes into accountthe characteristics of the noise supposed to be white and gaussian. Thisdata match term is sensitive to high frequency noise and must be balancedwith regularization term which corresponds to a mathematical prior on theexpected solution (Idier, 2008).2. A sparsity regularization term �KPFS�1 is chosen for the kernel, i.e. : the�1 norm (sum absolute value) of the kernel must be low. Indeed, the PFSkernel is supposed to be composed with few diracs at mechanical vibrationfrequencies.3. A smooth regularization term is chosen for the Mars spectra : �D�IMars�22,where D is a discrete first-order derivation operator. This prior promotessmooth solution in order to avoid noise improvement.All these terms are balanced with two hyperparameters λK and λMars , bothpositive. The functional 6 is convex for each variables - convex in IMars whenKPFS is fixed and vice versa - but not from the couple (IMars,KPFS). The51752.pdf
45th Lunar and Planetary Science Conference (2014)
is compatible with the observation. The L2 distance is relatively small (∼ 0.013).  In addition, a complete ab initio approach allows us to estimate the vibration frequencies from different sources: reaction wheels, Inertia Measurement Units and PFS eigenmodes. Thanks to telemetry data from ESA, it is possible to estimate the frequencies of reaction wheels for ORB0032, spectra No 106 at 56.7 Hz, 33.3 Hz, 40.6 Hz and 30.3 Hz. Astrium technical specification of MEx states that the IMU dithering onboard MEx are at 513.9 Hz, 564.3 Hz and 617.4 Hz. The PFS eigenmodes are around 135 Hz and 160 Hz. Not all of these micro-vibration frequencies are expected to be active, depending on the relative phase. Figure 3 represents the ab initio expectation of the micro-vibration effect on the laser line in gray color. The four main picks are compatible with ab initio informations, but also smaller picks.      Figure 2: Final results of the spectra ORB0032 #106 as compared with stacking and synthetic measurements, from top to bottom: (i) raw PFS measurements, all arrows represents ghosts artifacts, (ii) estimated spectra from our algorithm, (iii) synthetic measurement of PFS, (iv) stack of 11 PFS spectra, (v) stack of 11 estimated spectra from our algorithm. The arrow at 2900 cm−1 represents the mirror contamination by hydrocarbons, the arrow at 4900 cm−1 represents an artifact of abnormal small signal, probably due to ghosts.   Figure 3: Modulus of the simulated laser line modulated Ifinal through filter, aliasing and vibration kernel Kfinal (blue), the observation I (red). The lack of fit is 0.0270. The microvibrations effect on the laser line computed ab initio using telemetry is in gray.  Discussion and conclusion: We described the approximated direct problem and an algorithm able to correct for the mechanical vibration of the PFS instrument. For the first time, we show that it is possible to reduce significantly the ghosts from the observed signal from 3-5 % of the total energy to 0.4-0.7 %. Our estimation is coherent using three quantities: ghosts in the signal domain, laser line ghosts, distance to approximated kernel. Thus the global shape of PFS SWC spectra can be corrected with our algorithm, allowing to better estimate temperature, and thermal profile on each PFS measurement, improving the few % of spectra with high χ2 that could not be processed with current calibration. Also, our correction may avoid the continuum removal step in the minor species retrieval. When the signal to noise ratio is high enough, our correction will also reduce the stacking procedure. In the future, we would like to propose an algorithm to correct the complete archive that would require: efficient algorithm, timesaving implementation, and fully automatic procedure. Also, new correction procedure must be developed to treat the whole orbits currently available (>6400 at the date of writing).  Reference: [1] Formisano, V., et al. (2005) PSS 53 (10), 963–974. [2] Giuranna, M., et al. (2005) PSS 53 (10), 993–1007. [3] Giuranna, M., et al. (2005) PSS 53 (10), 975–991. [4] Comolli, L. et al. (2010) PSS 58 (5), 864-874 [5] Shatalina, I. et al. (2013) Aerospace Science and Technology submitted. [6] Schmidt, F. et al. (2014) PSS accepted [7] Idier, J. (2008) Bayesian Approach to Inverse Problems 0 500 1000 1500 2000 2500 3000 3500 4000 4500 5000−8−6−4−20246810ORBIT 0032: MARTIAN spectrum #106Wavenumber (cm−1)Modulus, (DN), shifted for clarity  !!"" " " """ " "data: IPFSestimation: IfMarssynthetic: IfMarsstack: IPFSstack: IfMarsFigure 5: Final results of the spectra ORB0032 #106 as compared with stacking and syntheticmeasurements, from top to bottom : (i) raw PFS measurements, all arrows represents ghostsartifacts, (ii) estimated spectra from our algorithm, (iii) synthetic measurement of PFS, (iv)stack of 11 PFS spectra, (v) stack of 11 estimated spectra from our algorithm. The arrowat 2900 cm−1 represents the mirror contamination by hydrocarbons, the arrow at 4900 cm−1represents an artifact of abnormal small signal, probably due to ghosts.130 500 1000 1500 2000 2500 3000 3500 4000 4500 5000−10−8−6−4−20246810ORBIT 0032: MARTIAN spectrum #106Wavenumber (cm−1)Modulus, (DN), shifted for clarity  noise : 0.17   ghosts : 100%noise : 0.07   ghosts : 15%noise : 0.05   ghosts : 8%noise : 0.05   ghosts : 6%noise : 0.05   ghosts : 7%noise : 0.04   ghosts : 6%!!!data: IPFSestimation: IfMars3 stack: IfMars5 stack: IfMars11 stack: IfMars19 stack: IfMars0 500 1000 1500 2000 2500 3000 3500 4000 4500 5000−10−8−6−4−20246810ORBIT 0032: MARTIAN spectrum #106Wavenumber (cm−1)Modulus, (DN), shifted for clarity  noise : 0.17   ghosts : 100%noise : 0.07   ghosts : 15%noise : 0.1   ghosts : 45%noise : 0.07   ghosts : 24%noise : 0.05   ghosts : 14%noise : 0.03   ghosts : 5%!!!data: IPFSestimation: IfMars3 stack: IPFS5 stack: IPFS11 stack: IPFS19 stack: IPFSa bFigure 6: Comparison of our correction versus the stacking method : (a) Stacking of correctedspectra from our method (b) Stacking of PFS spectra. Noise standard deviation from the 11530 cm−1 are expressed for all spectra. Fraction of energy due to ghosts, relative to the rawPFS spectra in 1-1530 cm−1 is also written for all spectra. Arrows at 2700 cm−1 representsignificant diﬀerence in the signal domain due to ghosts, that persists for stacking of at least5 PFS spectra but well corrected by our method.5500 6000 6500 7000 7500 800001234567wavenumber, cm−1Modulus, (DN)ORBIT 0032 #106 : Laser Ghosts check  measured ghostevaluated from Kfinalevaluated from vibrationsFigure 7: Modulus of the simulated laser line modulated IˆfinalLM through filter, aliasing andvibration kernel KˆfinalPFS (blue) and the observation ILM (red). The lack of fit is 0.0270141752.pdf
45th Lunar and Planetary Science Conference (2014)
