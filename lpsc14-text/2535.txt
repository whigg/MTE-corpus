2535.PDF
PRACTICAL PROCESSING OF MARS EXPRESS HRSC IMAGES IN ISIS AND SOCET SET. R. L. Kirk1, K. L. Edmundson1, E. Howington-Kraus1, B. Redding1, O. Thomas2, R. Jaumann3, and the HRSC Co-Investigator Team, 1Astrogeology Science Center, U. S. Geological Survey Flagstaff, AZ 86001, U.S.A. (rkirk@usgs.gov), 2Cardinal Systems, Flagler Beach, FL 32136, 3DLR, Berlin, Germany. Introduction: We have created and describe here a set of software tools for analysis of images from the Mars Express High Resolution Stereo Camera (MEX HRSC) [1]. HRSC is a pushbroom scanner with 9 detector lines, enabling it to obtain multiple stereo views of a target region and/or color coverage on a single orbital pass. To date about 90% of Mars has been imaged with ground sample distances of 12.5 m (nadir channel at periapse) and greater, and the team has produced digital topographic models (DTMs) with post spacings of 50 m and greater for about 40% of the planet by use of a VICAR (Video Image Communication and Retrieval) processing pipeline [2,3]. Our approach uses the USGS digital cartography system ISIS (Integrated Software for Imagers and Spectrometers) [4,5] and the commercial stereomapping software SOCET SET ® from BAE Systems [6], and is thus independent of the VICAR pipeline. The work reported here is a continuation of our earlier development effort [7] that was evaluated as part of the HRSC team’s digital topographic model (DTM) comparison project [8]. It incorporates substantial advances in many areas of the software, leading to improvements in DTM quality and large improvements in usability.  We had several goals in undertaking this development: • To provide an independent verification of the results of the stereo pipeline used to produce archival products by the mission team • To assess the quality of DTMs we could produce (using software and techniques we apply to many other missions) in relation to other approaches and especially those tailored specifically for HRSC • To enable members of the planetary community who do not have access to the specialized VICAR software used by the HRSC team to produce their own DTMs and orthorectified (map projected) image products, particularly in the interval between the release of the images and the delivery of higher-level derived products by the team • To make ISIS processing capabilities that are unique or particularly strong, in particular photometric modeling and correction [9] and photoclinometry (shape-fromshading) [10], available for use with HRSC data The capabilities described below are now available to the planetary science community in the latest releases of ISIS and through the NASA-USGS Planetary Photogrammetry Guest Facility [11], which provides access to (and training for) SOCET SET. Technical Approach and Relation to Past Work: For HRSC, as for a wide variety of other planetary imagers, we utilize BAE Systems’ SOCET SET for stereo processing, including controlling images by bundle adjustment, producing initial DTMs by automated image matching, interactive quality control and editing of DTMs, and projection of images onto the DTMs to form orthoimages. We use ISIS to ingest the images and metadata in standard formats used by the mission and translate them into formats readable by SOCET SET. ISIS can also be used to orthorectify images (using an already existing DTM), and to re-ingest the SOCET products. It provides a host of standard functions such as image display and measurement, map transformations, mosaicking, and formatting of products for use with other (e.g., GIS) software or for PDS archiving. To avoid the need to develop HRSC-specific radiometric calibration software, we make use of the “Level 2” image products, which are already calibrated but still in native camera geometry [2]. (Note that these images would be called “Level 1” in the system of [12] commonly used in descriptions of ISIS processing). At the start of HRSC operations in 2004, the USGS was developing a new software system, ISIS 3 [5] to replace its earlier ISIS 2 [4] software. Because the new system was not yet fully operational, we opted to use ISIS 2 and implemented programs to ingest HRSC Level 2 images in VICAR and Planetary Data System (PDS) formats and to translate the images from ISIS to SOCET format. We also created sensor model software to enable geometric calculations including orthorectification and photometric modeling with existing ISIS programs. The generic pushbroom scanner sensor model was used in SOCET SET. A major shortcoming of both the ISIS and SOCET sensor models at the time was that they assumed a constant exposure time per line. HRSC typically changes its exposure time within an image (as often as every few hundred lines), so it was necessary to split observations into multiple files and handle them separately. Neither sensor model handled images reduced by averaging blocks of pixels into “macropixels,” so such images had to be enlarged to full size before use. Bugs in SOCET SET made it impossible to constrain the various channels (fore and aft stereo, nadir, etc.) of the HRSC to move together during the control calculation, and to perform stereomatching between more than 2 images at a time (though the situation was still better than ISIS, which had no software to control pushbroom images until 2005 and has no automated DTM production to date). None of these problems was insurmountable, but they had two general consequences: (a) much of the strength of HRSC as a multi-line stereo scanner was lost because the images had to be controlled separately and matched in pairs rather than multiples; and (b) the labor of mapping with HRSC was multiplied enormously because large numbers of image segments had to be controlled independently and matched in many different pairwise combinations (as well as at different grid spacings to produce best results on both steep and bland areas), and then the results combined to produce a single DTM. These difficulties were directly reflected in the conclusions of the HRSC team’s DTM comparison project [8]: that the quality of the SOCET DTMs was reasonable but not as good as those produced by algorithms that made use of multiple images in matching, and that the human work effort greatly exceeded that for other approaches. On the positive side, we were able to demonstrate unique ISIS capabilities for photometric modeling, “sharpening” of the DTMs by photoclinometry, and photometric processing [7]. Recent Developments: In 2009 we began developing ISIS 3 software for HRSC, including a sensor model that handled changing exposure times, but competing priorities prevented us from completing this work. Incidental 2535.pdf
45th Lunar and Planetary Science Conference (2014)
  progress was steady in both ISIS and SOCET SET over the next few years. ISIS 3 has matured rapidly and includes both interactive and manual tools for collecting the tiepoints needed to control images. Its control adjustment program, jigsaw [13], now adjusts trajectory as well as pointing, handles pushbroom scanners and can impose the constraint that the channels of a multiline scanner like HRSC must adjust together. BAE has fixed the bugs that limited our earlier HRSC processing and has developed a new image matching module (Next Generation Automatic Terrain Extraction, or NGATE) that performs dense matching with feature-based as well as area-based methods [14]. Subsequent development of NGATE has greatly improved its performance on “desert” (bare-ground) surfaces; though developed for the Earth, this has proved extremely helpful for extraterrestrial mapping. In 2012-2013 we returned to the problem of improving pushbroom sensor models. The end result was an improved set of core routines for the ISIS 3 pushbroom sensors and a new “USGS pushbroom sensor model” for SOCET SET. These developments share a common code base and the following features: • Faster and more robust solution algorithm to determine the image line on which a given ground point appears • Handling of constant or varying line exposure times in the same base model • Handling of pixel-averaging modes and detectors at arbitrary locations in the focal plane • Handling of images obtained by spacecraft rotation as well as translation, allowing (for example) analysis of Phobos observations Status and Plans: We are in the process of evaluating and debugging the new software just described, and developing the appropriate procedures for its routine use to make “custom” HRSC DTMs and orthoimages. The data sets used for the HRSC DTM comparison [8] have been analyzed and documented in detail and provide an ideal benchmark for both DTM quality and work effort. The DTM test datasets include a single orbit (h01235) over western Candor Chasma, with multiple kilometers of relief and constant line exposure time, and a set of three adjacent orbits with varying line time (h0894, h0905, h0927) over Nanedi Valles, with higher image quality but less local relief. Using the current software we have easily ingested the test images and produced initial DTMs based on a “conventional” approach to control that is based on manual collection of ground control points that are identifiable in both the images and the MOLA global altimetry dataset [15]. The quality of initial DTM products from NGATE without interactive editing or merging of the results from multiple image combinations is similar to or better than that of the highly edited products submitted for the 2006-7 DTM comparison. In particular, it is no longer necessary to merge multiple DTM segments or to edit the almost featureless plateau areas surrounding Candor Chasma; the new NGATE algorithm interpolates such terrain with far fewer artifacts than the older method. We are experimenting to optimize the parameter values (“matching strategy”) for NGATE and anticipate that the quality of the matching results can be further improved with relatively little effort. We will investigate the results of presmoothing the images to suppress compression artifacts, a technique that has been shown to improve the quality of DTMs from the standard pipeline [3]. We have recently demonstrated that we can control stereopairs (e.g., HiRISE [16]) consisting of independently acquired images with greatly reduced interactive effort by applying surface fitting techniques (cf. [17]). Rather than searching interactively for identifiable ground control points in the MOLA dataset, we perform an initial, strictly relative control adjustment, make a coarse initial DTM in arbitrary coordinates, and then determine the transformation that fits this free-floating DTM to the MOLA surface. We currently use a commercial package, Geomagic Control (formerly Qualify: http://www.geomagic .com/en/products/qualify/overview) to do the fitting, but a variety of open-source alternatives are or soon will be available. By applying the same transformation to the image-to-image tiepoints in the free-floating coordinate system, we effectively convert them to ground control points that can be used in a final, absolute control calculation. We are currently working to extend this procedure for use with HRSC images, for which the trajectory and pointing history of all the image channels must be identical as a function of time. Once this largely automated control procedure is working for HRSC, we will document the absolute errors, noise, resolution, and work effort for the Candor Chasma and Nanedi Valles data sets using the HRSC DTM comparison results [8] as a benchmark. We will also use HiRISE-derived DTMs, which have 1 m sampling interval and submeter vertical precision to assess the vertical precision and horizontal resolution of our HRSC DTM products. The MSL landing sites, which have extensive HiRISE DTM coverage, provide an ideal opportunity for this comparison.  The software described here is, for the most part, already available to the planetary community. The current ISIS 3 release contains the HRSC sensor model and translation programs, and the USGS pushbroom sensor model for SOCET SET is available on request. For those who do not have their own SOCET workstations, training and access to workstations at the USGS, Flagstaff are available through the Planetary Photogrammetry Guest Facility [11]. Although bug fixes to the current software will no doubt be needed for some time to come, the main work remaining will be the development and documentation of standard procedures for making topographic map products from HRSC data. References: [1] Neukum G. et al. (2004) Nature 432, 971. [2] Scholten F. et al. (2005) PE&RS 71, 1143. [3] Gwinner K. et al. (2009) PE&RS 75, 1127. [4] Eliason E. (1997) LPS 28, 331; Gaddis L. et al. (1997) LPS 28, 387; Torson J. and Becker K. (1997) LPS 28,1443. [5] Anderson J.A. et al. (2004) LPS 35, 2039. [6] Miller S. B. and Walker A. S. (1993) ACSM/ASPRS Annual Conv., 3, 256; - (1995) Z. Phot. Fern. 63, 4. [7] Kirk R. L.et al. (2006a) LPS 37, 2050.; — (2006b) IAPRS 36(4); — (2006c) EPSC 2006, 487. [8] Heipke C. et al. (2007) PSS 71, 1153. [9] Kirk R. L. et al. (2000) LPS 31, 2025; — (2001) LPS 32, 1874. [10] Kirk R. L. et al. (2003) ISPRS WG IV/9 Workshop, Houston, http:// astrogeology.usgs.gov/Projects/ISPRS/Meetings/Houston2003/abstracts/Archinal_isprs_mar03.pdf. [11] Kirk R. L. et al. (2009) LPS 40, 1414. [12] Batson R. M. (1995) in Planetary Mapping, Cambridge, 86. [13] Edmundson K. L. et al. (2012) IAPRS I(4), 203. [14] Zhang B. et al. (2006) ASPRS Ann. Conf., Reno; Zhang B. (2006) GeoCue 2nd Ann. Tech. Exchange Conf., Nashville. [15] Smith D. et al. (2001) JGR 107, 23689. [16] Kirk R. L. et al. (2008) JGR 113, E00A24. [17] Lin S.-Y. et al. (2010) EPSL 294, 520.  2535.pdf
45th Lunar and Planetary Science Conference (2014)
