 IMPROVEMENTS TO HIGH RESOLUTION LROC NAC DIGITAL TERRAIN MODELS.   M. R. Henriksen1, P. Seymour1, K. N. Burns1,  E. J. Speyerer1, M. S. Robinson1 and the LROC Science Team, 1School of Earth and Space Exploration, Arizona State University, Tempe, AZ 85251, USA. (mhenriksen@ser.asu.edu) Introduction:  The Lunar Reconnaissance Orbiter Camera (LROC) includes two Narrow Angle Cameras (NACs) that provide 0.5 meter-scale panchromatic images of a 5 km swath from an altitude of 50 km [1]. One of the primary objectives of LROC is to acquire stereo observations with the NACs to enable production of high-resolution digital terrain models (DTMs) [1].  Although the  NAC was  not  designed  for  stereo imaging, the spacecraft can roll off nadir over several orbits and acquire geometric stereo observations with nearly invariant lighting conditions. The NAC stereo images are reduced to DTMs using a combination of the USGS Integrated Software for Imagers and Spectrometers (ISIS) and SOCET SET® from BAE Systems [2,3]. From the final DTM, several derived products are made including orthorectified images, a shaded relief image, a color slope map, and a confidence map. The LROC team implemented  several  recent  improvements to automate time-consuming steps of the DTM generation process, to minimize errors and decrease the production time. In addition, DTMs are now being  controlled  to  multiple  LOLA tracks  using  a faster,  automatic  registration  method  [4].  These  improvements have led to an increase in production and absolute accuracy of NAC DTMs. Process Automation:  Since May 2013, the DTM production team at ASU has taken many steps to maximize the rate of DTM production through process automation and optimization. The average time required to generate a single stereo-pair  (two NAC pairs overlapping  to  produce  stereo  coverage)  DTM  has  decreased from approximately one week for the average project to approximately two work days, including processing time. So far we have finalized 79 DTMs using these new methods (May 2013 and January 2014). Efficiencies were gained through the creation of customized programs that interface with SOCET SET® and by taking advantage of more internal SOCET SET® capabilities. During previous methods of DTM production [5], a user was required to build project-specific configuration  files  and  interact  with  the  Windows  command-line. These steps involved significant user input and required detailed training. The ASU DTM production team built customized tools that successfully automate these manual tasks. These tools save time, minimize the potential for user error, and simplify project tracking, allowing multiple users to work on a single project. The  ASU  team  also  leveraged  built-in  SOCET SET®  tools to accomplish more automation, including image  footprints  during  DTM  generation  and  Automatic Point  Measurement (APM). Using image footprints allows a user to generate a DTM without manually drawing DTM boundaries. This tool, however, introduces  some additional  artifacts  that  are  easily  removed during DTM editing. APM takes place prior to DTM generation and allows for the automated selection of tie points between images.  Before generating DTMs, each stereo pair is bundle adjusted to align the images and improve camera-pointing information. Until the summer of 2013, all tie points were placed manually. Now, a few initial tie points are placed manually, followed  by  an  initial  bundle  adjustment.  Then  the APM tool is used to automatically place most of the remaining tie  points  for  the stereo  model.  Afterwards, three-way tie points are added in the seam between the NAC-Left  and  NAC-Right  images  to  eliminate  any vertical offsets across the seam. The APM tool has limitations, but the ASU team has configured it to work successfully for most stereo pairs. Registration:  NAC DTMs have a spatial sampling of 2-5 meters (dependent on native pixel scale of the stereo images) with a vertical precision of 1-2 meters. To ensure their absolute accuracy, first iteration DTMs are controlled to altimeter profiles from the Lunar Orbiter Laser Altimeter (LOLA) [6]. LOLA profiles are comprised of five separate laser observations taken approximately  every  60  meters  measuring the  distance between the spacecraft and the lunar surface to an accuracy of +- 0.1 meters [7]. Even with uncertainties in spacecraft  positioning,  which  have  greatly  improved with the inclusion of the GRAIL gravity model, LOLA altimeter profiles provides the most accurate geodetic reference frame of the Moon [7]. Before April  2013, the standard registration technique was a manual optimization using the MATLAB environment.  This  process  of  manual  registration required the analyst to match two LOLA profiles separately to the first  iteration DTM with high accuracy. The process, however, required substantial time investment by the analyst. The LROC team developed an automated  tool  using the  Optimization  Toolbox within MATLAB [4].  This program eliminates the  need for manual adjustment  during each iteration of  the optimization. The  registration  process  begins  with  two  input files: a GeoTIFF of the relevant first iteration DTM exported from SOCET SET® and a CSV data file recording the relevant LOLA tracks over the DTM. The CSV data file can be retrieved automatically from an internal  LROC LOLA database,  or downloaded from the LOLA team web portal. The LOLA data is sorted to eliminate any tracks with incomplete or unreliable positioning (e. g. off-nadir acquisitions when the space craft slew rate is  changing or night side tracks).  For each remaining track an optimization algorithm is employed to map the five profiles as closely to the GeoTIFF as possible. This optimization takes into account nine variables representing latitude, longitude, elevation,  yaw,  pitch,  roll,  and  three  variables  for  scale. These  variables  are adjusted within the  algorithm to produce the lowest possible root mean squared (RMS) error between the adjusted LOLA track and the DTM. Finally, a user must manually select the desired control points from a graphical  representation of each track. Automation of this final step proved less reliable since the area selected must posses a number of geographic characteristics (e.g. not a sharp slope or crater wall). The coordinates acquired by the MATLAB routines are exported back in to SOCET SET®. A final bundle adjustment  is  performed with  the  LOLA registration control points to improve the absolute positioning of the final iteration NAC DTM. The automation of LOLA registration reduced the time and effort  requirements  for  registering multiple LOLA tracks, resulting in more accurate DTMs (and thus more accurate orthophoto maps). The original registration method took an average of four hours for a single profile, and in extreme cases could take much longer. Now every valid profile across a DTM is registered in less than five minutes, thus eliminating profile registration as a major bottleneck in the DTM production pipeline. Error Analysis: Basic error analysis is performed on each DTM to evaluate both relative and absolute accuracy.  Relative  accuracy  is  measured  internally  for each DTM in SOCET SET® and recorded as the Relative Line Error (LE). The LE value correlates to the relative precision of the DTM. This value is expected to  be  less  than  the  precision  of  the  DTM  (2  to  5 meters/pixel). The LE values of NAC DTMs have remained consistent throughout the recent  pipeline improvements. The absolute error of a DTM is evaluated by comparing  the  final  DTM to  corresponding  LOLA data. RMS and average vertical  offsets between the DTM and LOLA are calculated using a method very similar to initial profile-to-DTM registration. Other errors such as tilt and twist in the DTM are evaluated simultaneously (Fig. 1). Both the average RMS and average zoffsets for DTMs produced using these new methods have decreased. Prior to April 2013, the average RMS offset for all DTMs was 5.40 m. For all DTMs produced after April 2013, the average RMS offset for all DTMs was 2.71 m. In addition, there is now little evidence of tilt  in NAC DTMs, which occasionally appeared when registering to only a single LOLA profile. Mare Imbrium DTM Comparison. Using the new automated  production  technique,  we  reprocessed  the NAC DTM covering a portion of Mare Imbrium. Figure 1 shows there was a clear tilt across the original DTM resulting in a 20 m error when comparing the East  and Western extent of  the DTM in the original product produced in 2012.  While this tilt is only 0.08°, the new process which encompassed registering multiple LOLA altimeter profiles removed the tilt and constrained the systematic offsets to under 2 meters. Current LROC DTM Status: Currently 170 NAC derived DTMs have been released through the LROC PDS archive, including 48 of which were released in December 2013.  Included in these releases are three DTM mosaics, consisting of multiple stereo pairs: Larmor Q, Lassell Massif, and the Luna 21/Lunokhod 2 landing sites. Approximately 0.09% of the lunar surface is now included in finalized DTMs and that number is expected to increase relatively quickly with the efficiencies in the pipeline. In addition to creating new DTMs, previously released DTMs will be redone and re-released as they are completed. Figure 1. Radial offset between an LROC NAC DTM  and the LOLA altimeter profiles using both the old and  new production methods. References: [1] Robinson, et al. (2010) Space Sci.  Rev., 102, 293-298 [2] Anderson, et al. (2004)  LPSC XXXV, Abstract #2039. [3] DeVenencia, et al. (2007) Photogrammetric  Week, 297-308.  [4]  Speyerer  et  al. (2012) European Lunar Symposium [5] Burns, K.N. et al.  (2012)  ISPRS  XXII,  483-488.  [6]  Mazarico,  E. (2013) LPSC XXXXIV, Abstract #2414.[7] Zuber, M. T. et al. (2010) Space Sci. Rev. 150:63-80.  