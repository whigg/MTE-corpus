1791.PDF
LINMIN: MINERALS DETECTION TOOL FOR HYPERSPECTRAL IMAGES. F. Schmidt1, M. Legendre2, S. Le Mouelic3, 1Univ Paris-Sud/CNRS, IDES, UMR8148, Orsay, F-91405, France (frederic.schmidt@u-psud fr), 2IRCCyN, CNRS, UMR 6597, Ecole Centrale Nantes, France, 3LPGN, CNRS UMR 6112, Universite de Nantes, France   Introduction: Detecting minerals on a very large hyperspectral dataset (> To) is a difficult task that may be solved using fast linear unmixing techniques under constraints of positivity and sum-to-one. We test different algorithms and different reference database on synthetic data simulating the observation. We show that new algorithms can handle linearly dependent spectra in the database as expected theoretically. This possibility offers a new opportunity to detect minerals in very hard condition such planetary surfaces.  In remote sensing hyperspectral imaging, a set of images is recorded at various spectral bands by the sensor that measures the solar light reflected and scattered back from the surface and from the atmosphere. We modeled this transfer as a linear mixture of the scene component spectra (endmembers) and additional spectra. Using matrix notations, one can write:  X ≈ AS    (1)  where each row of X contains the p-th pixel spectrum and matrix S contains the endmember spectra S. In this model, the weight A of each component spectrum S is related to its abundance in the surface area corresponding to the underlying pixel. Supervised linear unmixing problem consists of estimating matrix A knowing X and S, in contrary to unsupervised unmixing that consists of estimating matrix A and S, knowing only X [1]. A first hard constraint is the nonnegativity of the elements of A since they correspond to abundances of the surface components:   Ap,r≥0, ∀p,r    (2)  A second constraint that may be imposed is the sum-to-one (additivity) constraint on the abundances that should sum to unity for each pixel p:   Σr Ap,r=1, ∀p    (3)  Thanks to both constraints (2) and (3), the problem is not undetermined using some linearly mixed spectra S. We tested here the behavior of two algorithms to fit the continuum using this possibility.  Method: In order to estimate the detection limit in a realistic but very hard condition, we created a synthetic dataset made of 1000 spectra: 90% of flat spectra and 10% of a random binary mixture. We then alterate these spectra by using a radiative transfer model to simulate the reflectance observed at the spacecraft using the aerosols optical properties from Vincendon et al. [2]. The aerosols content is defined by the Aerosols Optical Thickness (AOT). Then we add the noise simulating the instrument noise (from OMEGA dark current). An other synthetic test was performed by changing the grainsize using Shkuratov theory [3]. The FCLS method solves the unmixing problem under non-negativity and sum-to-one constraints [4]. Since no closed form expression of the optimal abundance vector can be derived under these two constraints, an iterative scheme is developed. The nonnegativity constraint is classically handled by introducing the Lagrange function associated with the criterion to be optimized. The sum-to-one constraint is considered as an additional measurement equation leading to a new cost function. This method was previously tested to detect ices and liquid water on Mars [5]. An alternative approach, called IP-FCLS was recently developed [6] using primal-dual interior point optimization approach. For both algorithms, we tested different reference spectral database S, including several linearly dependent data.  Figure 1: Reference database of 32 spectra. Results: Figure 1 presents the collection of 32 reference spectra from laboratory measurements and synthetic data [7] that from our expertise is the best compromise to fit the data using FCLS.  It corresponds to 1 1.5 2 2.500.10.20.30.40.50.60.70.80.91EndmemberWavelength (microns)ReflectanceFigure 2: 32 Reference spectra of minerals, ice and atmospheric gas representing major classesof contributions of surface spectra. See Appendix for the names.The estimated mixing coeﬃcients are noted AIPLS , ABI−ICE and AIPLS,cov190for the renormalized problem.191Examples of fits are shown in fig. 4 on left with AOT=0.192Figure 3 compares estimated AIPLS,cov and actual A0 mixing coeﬃcients,193for the IPLS algorithm using 32 and the 4 additional spectra, on the 1000 binary194mixture, with the renormalized unmixing problem. Usually, AIPLS,cov for actu-195ally present endmember (ApositiveIPLS,cov in green), are well separated from the absent196endmember (AfalseIPLS,cov in red), showing that a simple threshold can be used to197detect the endmember. Endmember No 18 (Magnetite) is not detectable be-198cause there is no diﬀerence between ApositiveIPLS,cov and AfalseIPLS,cov . Please note that199ApositiveIPLS,cov and Apositive0 are very close, the mean absolute diﬀerence is 0.0142,200one order of magnitude lower than the mixing coeﬃcients (up to 10%), showing201that when linear mixing is true, the estimated mixing coeﬃcients are validated202as real abundances. Also, the root-mean-square (RMS) error is compatible with203the level of noise (1.2× 10−3).204In order to estimate the best threshold CiIPLS,cov, avoiding the maximum205number of false detection but keeping the maximum positive detection, we pro-206pose the following formulation, for each endmember i:207CiIPLS,cov =12�mean(ApositiveIPLS,cov)− 2.std(ApositiveIPLS,cov) +mean(AfalseIPLS,cov) + 6.std(AfalseIPLS,cov)�(7)Figure 3 shows these threshold for all endmembers. It confirms that some end-208members can be detected with a larger detection limits than other, depending20971791.pdf
45th Lunar and Planetary Science Conference (2014)
the maximum linearly dependent spectra allowed in the algorithm. If one adds the positive slope for instance, the matrix inversion of the FCLS algorithm fails.  This behavior is not present for the IP-FCLS algorithm since no matrix inversion is involved. One can add many linearly dependant spectra, opening the possibility to better fit the continuum and tackle the nonlinearity due to complex radiative transfer in the surface and atmosphere. In practice, the most reasonable additional artificial spectra are a basis of sine and cosine at very large wavelength in order to fit the general shape of the continuum (4x and 2x period in order to prevent from specific absorption bands of some minerals, like pyroxenes).    Figure 2: Examples of results using the IPLS algorithm: a) and b) with renormalization and 12 additional spectra (flat and slope) in the case of pure gypsum spectra (10% in abundance). a) with different grain size factor, from x1000 to x1/1000, b) with different atmospheric load from AOT=0 to AOT=100.  In the case of the slope, figure 2 shows examples of results for gypsum for the grain change test and the atmospheric opacity test. Figure 3 shows the summary of 1000 mixture for each AOT. More than 80% (false detection < 5%) of the minerals can be detected with our methods with a decreasing efficiency with increasing aerosols optical thickness. When, the raw spectra are directly used, the detection limits is below 60% (false detection > 30 %), showing clearly the usefulness of the additional spectra. The dependence on aot is very low for AOT <0.1 but the detection rate is still 70% for AOT=1.   Figure 3: Positive detection rate (circle) and false detection rates (square) with optimized threshold as a function of AOT for IPLS. For each algorithm, the positive/false detection rates are computed using 32 endmember spectra only (no slope), or 44 endmember spectra including additional spectra (slope). IPLS has an option of sum-lower-than-one (slo) or sum-to-one (sto). The case without aerosols is plotted at AOT=10−3. Discussion and conclusion: We showed that recent algorithms of linear unmixing including positivity and sum-to-one constraints could provide new possibility to fast fit the continuum in addition to “spectral abundance” estimation, in particular GPU implementation of IP-FCLS [7].  Reference: [1] Schmidt, F., et al., IEEE TGRS, 48, 4003-4013, 2010 [2] Vincendon, M., et al., JGR, 112, 8–+, 2007. [3] Shkuratov, Y., et al., Icarus 137 (2), 235–246, 1999 [3] D. Heinz and C.-I. Chang, IEEE TGRS, 39, 529–545, 2000. [4] Kereszturi, A. et al., PSS , 59, 26- 42, 2011 [5] Chouzenoux et al., GRETSI Conference (2011) [6] S. Le Mouélic, et al., 2009. WHISPERS, 26-28 Aug. 2009, [7] Schmidt F. et al., submitted to Icarus, 2014 1 1.5 2 2.50.320.340.360.380.40.420.440.46Detection of Gypsum (10 %)WavelengthReflectance (offset for clarity)  fact=1000 (ab = 0~0 %)fact=10 (ab = 6.1~0 %)fact=1 (ab = 9.8~0 %)fact=1/10 (ab = 5.4~0 %)fact=1/1000 (ab = 0.7~0 %)1 1.5 2 2.50.340.360.380.40.420.440.460.48Detection of gypsum (10 %)WavelengthReflectance (offset for clarity)  aot=0 (ab = 9.8~0 %)aot=1 (ab = 5~0 %)aot=5 (ab = 1~0 %)aot=100 (ab = 0~0 %)a bc d1 1.5 2 2.50.330.340.350.360.370.380.390.40.41Detection of clinopyroxene(10 %)WavelengthReflectance (offset for clarity)  aot=0 (ab = 9.8~0.2 %)aot=0.5 (ab = 7.1~0.2 %)aot=1 (ab = 5.5~0.2 %)aot=1.5 (ab = 4.6~0.2 %)1 1.5 2 2.50.330.340.350.360.370.380.390.40.41Detection of clinopyroxene(10 %)WavelengthReflectance (offset for clarity)  aot=0 (ab = 9.8~2 %)aot=0.5 (ab = 5.4~2.3 %)aot=1 (ab = 0.7~2 %)aot=1.5 (ab = 5.6~1.9 %)Figure 4: Examples of results using the IPLS algorithm: a) and b) with renormalizationand 12 additional spectra (flat and slope) in the case of a pure gypsum spectra (10% inabundance). a) with diﬀerent grain size factor, from x1000 to x1/1000, b) with diﬀerentatmospheric load from AOT=0 to AOT=100. ; c) and d) with renormalization in the case ofdiopside (clinopyroxene). c) using 4 additional spectra (flat and slope), d) using 12 additionalspectra (flat, slope and cosine).coeﬃcient is estimated to 5.5 ± 0.2%, showing a clear positive good detection.297We argue that all endmember with large scale absorption bands could have298the same behavior and thus, we prefer to use 4 additional spectra to detect299them. Users focused on spectra endmember with small scale features only, such300phyllosilicate, could use the 12 additional spectra.301As a summary, the best algorithm to detect non-linear coupling of a lin-302ear mixture under increasing aerosols content is IPLS with renormalization and303additional spectra. Please note that a diﬀerent threshold may change the posi-304tive/false detection rates but not change the relative accuracy of the classifica-305tion. Estimating the threshold for real case images is more diﬃcult due to the306possible diﬀerences between observation and reference spectra. Please note that307our test uses the same spectra in the spectral library and in the mixture.308111 1.5 2 2.50.320.340.360.380.40.420.440.46Detection of Gypsum (10 %)WavelengthReflectance (offset for clarity)  fact=1000 (ab = 0~0 %)fact=10 (ab = 6.1~0 %)fact=1 (ab = 9.8~0 %)fact=1/10 (ab = 5.4~0 %)fact=1/1000 (ab = 0.7~0 %)1 1.5 2 2.50.340.360.380.40.420.440.460.48Detection of gypsum (10 %)WavelengthReflectance (offset for clarity)  aot=0 (ab = 9.8~0 %)aot=1 (ab = 5~0 %)aot=5 (ab = 1~0 %)aot=100 (ab = 0~0 %)a bc d1 1.5 2 2.50.330.340.350.360.370.380.390.40.41Detection of clinopyroxene(10 %)WavelengthReflectance (offset for clarity)  aot=0 (ab = 9.8~0.2 %)aot=0.5 (ab = 7.1~0.2 %)aot=1 (ab = 5.5~0.2 %)aot=1.5 (ab = 4.6~0.2 %)1 1.5 2 2.50.330.340.350.360.370.380.390.40.41Detection of clinopyroxene(10 %)WavelengthReflectance (offset for clarity)  aot=0 (ab = 9.8~2 %)aot=0.5 (ab = 5.4~2.3 %)aot=1 (ab = 0.7~2 %)aot=1.5 (ab = 5.6~1.9 %)Figure 4: Examples of results using the IPLS algorithm: a) and b) with renormalizationand 12 additional spectra (flat and slope) in the case of a pure gypsum spectra (10% inabundance). a) with diﬀerent grain size factor, from x1000 to x1/1000, b) with diﬀerentatmospheric load from AOT=0 to AOT=100. ; c) and d) with renormalization in the case ofdiopside (clinopyroxene). c) using 4 additional spectra (flat and slope), d) using 12 additionalspectra (flat, slope and cosine).coeﬃcient is estimated to 5.5 ± 0.2%, showing a clear positive good detection.297We argue that all endmember with large scale absorption bands could have298the same behavior and thus, we prefer to use 4 additional spectra to detect299them. Users focused on spectra endmember with small scale features only, such300phyllosilicate, could use the 12 additional spectra.301As a summary, the best algorithm to detect non-linear coupling of a lin-302ear mixture under increasing aerosols content is IPLS with renormalization and303additional spectra. Please note that a diﬀerent threshold may change the posi-304tive/false detection rates but not change the relative accuracy of the classifica-305tion. Estimating the threshold for real case images is more diﬃcult due to the306possible diﬀerences between observation and reference spectra. Please note that307our test uses the same spectra in the spectral library and in the mixture.308111791.pdf
45th Lunar and Planetary Science Conference (2014)
