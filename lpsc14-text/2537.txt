 AUTOMATIC SEGMENTATION OF SPECTRALLY SIMILAR LUNAR SURFACE AREAS WITH EMPHASIS ON THE SPECTRAL ABSORPTION FEATURES.  M. P. Felder 1, A. Grumpe 1 and C. Wöhler 1; 1 Image Analysis Group, TU Dortmund University, D-44227 Dortmund, Germany; {arne.grumpe  marian.felder  christian.woehler}@tu-dortmund.de.   Introduction: The mapping of geologic units on the Moon requires tools to visualize complex information. Geological units on planetary bodies are commonly defined by lithostratigraphy or chemostratigraphy. Chemostratigraphic units are geologic units of similar geochemical and thus mineralogical composition. This composition may be remotely determined by decomposing remotely sensed reflectance spectra, e.g. extracted from hyperspectral images, into spectra of mineralogical endmembers, i.e. spectral unmixing [1]. One of the major issues in spectral unmixing is the determination of an appropriate set of endmember spectra. In [2] a method is proposed to automatically select endmembers from a given catalogue. The runtime of that method, however, is too high to be applied at a global scale. To simplify the unmixing problem, we propose a method to automatically segment the surface into geologic units clustering the observed reflectance spectra with emphasis on the spectral absorption features and extract prototype spectra corresponding to geologic units. All spectra inside one unit are then supposed to share the same endmembers. Thus, it is sufficient to determine the endmembers of the protopye spectra and apply spectral unmixing to the determined set of endmember spectra to the individual pixel spectra. Dataset: The proposed method is applied to our photometrically normalised global mosaic derived from hyperspectral data acquired by the Moon Mineralogy Mapper (M 3) [3] instrument. All M 3 images and the corresponding regions of the GLD100 digital elevation map [4] are resampled to 20 pixels per degree. The global mosaic covers a latitudal range of ±60°. The thermal emission component was estimated for each image and subtracted from the observed spectral radiances according to [5]. Afterwards, a channelwise single-scattering albedo according to the Hapke model [6] was estimated for each pixel by minimising the mean-squared deviation between the modelled and the measured spectral reflectance over all overlapping images [7], where the GLD100 topographic data set was used to model the influence of surface topography. The remaining parameters of the Hapke model were adopted from [8]. The normalised reflectance was computed by inserting the estimated single-scattering albedo and a standard illumination geometry of 30° incidence angle, 0° emission angle and 30° phase angle [9] into the Hapke model. Clustering Algorithm: The common cluster algorithms rely on the knowledge of the number of distinct clusters and a similarity measure. To allow for an arbitrary number of clusters, we apply a split and merge clustering algorithm (e.g. [10]). The similarity between spectra is determined by a decomposition into basis spectra. Initial clustering: The assumption that every measured reflectance channel contains useful information leads to problems of very high dimensionality. Hence, to reduce the dimensionality we apply a modified version of the algorithm in [11]. Initially, the most convex spectrum and its most distinct spectrum are chosen as basis spectra. Alle observed spectra are then expressed as a linear combination of the basis spectra. Iteratively, the spectrum with the largest residual RMSE is added to the set of basis spectra. In contrast to [11], we neglect the sum-to-one constraint and the non-negativity constraint of the coefficients because we are interested in a low-dimensional representation rather than a physically meaningful unmixing. Additionally, we modify the added basis spectrum by averaging all spectra showing a correlation with the basis spectrum exceeding a threshold of 0.99. In our scenario, four basis spectra are sufficient to represent all observed spectra up to a reflectance RMSE of 10 -8 . Thus, the dimensionality is greatly reduced. Finally, the spectra are divided into 12 clusters using a self-organizing map (SOM) [12] in the coefficient space. Cluster splitting: Since the real number of clusters is unknown and the result of the SOM depends on the random initialisation, we added a cluster splitting stage. The uniformity of the cluster-member spectra is estimated by computing the median spectrum and the 25% and 75% quantile spectra. To emphasize the absorption features, we compute the correlation of the continuumremoved (CR) median spectrum and both quantile spectra, respectively. If either of the correlation coefficient is below µsplit = 0.95, the cluster member spectra are again divided into three distinct clusters using a SOM in the coefficient space. Cluster merging: The cluster splitting algorithm tends to produce a large number of clusters. Some clusters, however, may originally coincide but are separated due to separation of the basis spectra in the initial clustering step. Hence, we compute the median spectrum of each cluster resulting from the splitting algorithm. This median spectrum is considered the  Figure 2: Continuum-removed prototype spectra. The spectra exhibit absorption troughs of variable depth near 1000 nm and 2000 nm. The position of the absorption band near 1000 nm varies across a wide range. Some prototype spectra show a shallow absorption band and others an inflection near 1300 nm. prototype of each cluster. To merge clusters with similar prototypes, we compute the pairwise correlation between all CR prototype spectra. Afterwards, we fuse the two clusters with the largest correlation coefficient that exceeds μmerge = 0.99. This procedure is repeated iteratively until no correlation value matches the criterion any more. Results: The 16 clusters obtained in our analysis reflect the basic types of lunar surface materials (Fig. 1). Mare regions are clearly separated from highland areas. Regions well known to consist of different types of mare basalt (high-Ti basalt in Mare Tranquillitatis and western Oceanus Procellarum vs. low-Ti basalts e.g. in Mare Imbrium and Mare Serenitatis [13]) are clearly distinguished. The highlands are characterised by prototype spectra with less pronounced absorption bands than the maria. Border regions between mare and highland areas are represented by specific prototypes of intermediate character. Fig. 2 shows that especially the prototype spectra of mare character  with deep absorptions exhibit a broad range of positions of the band near 1000 nm, indicating variations of the Ca content of pyroxene [14]. We expect that this set of protoype spectra will serve as a useful basis for future spectral unmixing analyses. References: [1] Keshava, N. and Mustard, J. F. IEEE Signal Processing Magazine, Jan. 2002, 44-57; [2] Felder, M. P. et al. (2013) Proc. European Planetary Science Congress, EPSC2013-684-3; [3] Pieters et al. (2009) Current Science 96(4), 500-505; [4] Scholten et al. (2012) JGR 117, E00H17; [5] Wöhler, C. and Grumpe, A. (2013) In: M. Breuß et al. (eds.), Innovations for Shape Analysis: Models and Algorithms, Springer-Verlag, 467-492; [6] Hapke, B. (2002) Icarus 157 (2), 523-534; [7] Grumpe A. et al. (2013) Adv. Space Res., in press; [8] Warell, J. (2004) Icarus, 167, 271-286; [9] Pieters (1999) Proc. Workshop on New Views of the Moon II, abstract #8025; [10] Ding, C. and He, X. (2002) Proc. IEEE Int. Conf. on Data Mining, 139-146; [11] Farzam, M. et al. (2008) Proc. Canadian Conference on Electrical and Computer Engineering, 837-842; [12] Kohonen, T. (1982) Biological Cybernetics, 43(1), 5969; [13] Lucey et al. (1998) JGR 103(E2), 3579-3699; [14] Smrekar, S. and Pieters, C. M. (1985) Icarus 63, 442452. Figure 1: Result of the clustering algorithm for the M³ mosaic. Colours denote cluster indices. 