 HRSC Data Dissemination - Dynamic Queries and Data Interoperability S. H. G. Walter (sebastian.walter@fu-berlin.de), S. van Gasselt Planetary Science and Remote Sensing Group, Institute for Geological Sciences, Department of Earth Sciences, Freie Universitaet Berlin, Malteserstr. 74-100, 12249 Berlin, Germany Introduction After 10 years of exploring Mars, the High Resolution Stereo Camera (HRSC, [1, 2]) has covered about 90 % of the surface in stereo and color with resolutions of up to 12 m/pixel. Derived digital elevation models (DTMs) of up to 50 m grid spacing cover about 40 % of the planet's surface [3]. The high lateral and vertical accuracy of the data products together with a precise photogrammetric alignment to MOLA make it an unique dataset perfectly suited for data fusion with other spectro-photometric and topographic data from the broad range of available remote sensing instruments at Mars. Fundamental assets for data analysis and data fusion are spatial and temporal queries, metadata search, data download and finally the ingestion of the data into desktop-based Geographic Information Systems (GIS). A dynamic web mapserver has been set up at Freie Universitaet Berlin in order to increase usage of HRSC data in the scientific community - compliant to geospatial standards and ready-to-use in the full range of GIS environments. The native HRSC data format is VICAR [4] which poses several limitations when im-/exporting or fusing data. We want to improve HRSC data interoperability by providing pre-processed data products, converted to common geospatial raster formats. Dynamic map server frontend The HRSC products are made available by an opensource driven dynamic mapserver optimized for orbit search and direct file download at http://maps.planet.fuberlin.de. Its frontend is based on the OpenLayers framework and access to the image data is provided by a Mapserver backend [5]. Two variants of the hillshaded MOLA dataset (grayscale and color-coded) are available as selectable base layers. The main query layer for HRSC product downloads is based on the level 4 footprints as described by Walter et al. [6]. By selecting an orbit footprint, a context window informs the user about basic image properties (acquisition date, incidence/emission angles and the projection type with its parameters) and the direct links to the product downloads. The mineralogical context can be blended in on demand as transparent overlay layers of the OMEGA global maps [7]. As an alternative to using the web frontend, the HRSC footprint geometries and attributes can be queried as a Web Feature Service (WFS) directly from the backend. Layers of the HRSC global mosaics currently in preparation by McGuire et al. [8] will be added as soon as they are ready for publication. Figure 1 displays a browser screenshot showing the color-coded MOLA background and a selected HRSC orbit. Figure 1: Dynamic map frontend for orbit location and download. http://maps.planet.fu-berlin.de HRSC data interoperability The Geospatial Data Abstraction Library (GDAL) is a cross-platform translator library for raster geospatial data formats [9]. Data formats are implemented as format specific drivers, some of which rely on external libraries. GDAL provides the primary raster data access engine for many applications and it is the most widely used geospatial data access library. Since version 1.4 it is able to read PDS-based files, but the generic character of the format leads to a loss of important mission- or instrumentspecific meta-information during file access. With VICAR being the native file format for HRSC, the development of a GDAL driver for VICAR turns the conversion to modern raster file formats such as GeoTiff or GeoJP2000 into a one-step process while providing fine-grained control over the preservation of HRSC's spacecraft- and instrument-specific metadata properties. The driver has been developed at Freie Universitaet Berlin, partly based on code of GDAL's existing driver for the PDS format. Current functionality is read access of single- or multiband VICAR data, including DTM data, with support for planetary projections and customdefined specific metadata in full compliance with the GDAL data model [10]. This enables elementary features of modern file formats during file access or con  http://maps.planet.fu-berlin.de http://maps.planet.fu-berlin.de http://maps.planet.fu-berlin.de http://maps.planet.fu-berlin.de 2version: the SRS and geotransform containment makes the image appear at the exact position in the map view; the correctly chosen nodata value shows only valid pixel values in the GIS while rendering non-valid values transparent and excluding them from image operations or statistical calculations; the embedded statistics of the bands show them properly stretched without the need of timeconsuming calculation; pre-rendered in-image overviews in reduced resolution (known as pyramids) allow for fast file access while panning and zooming; radiometric scale- and offset-values enable tracing back the original radiance/reflectance values of the HRSC instrument calibration. Table 1 shows an excerpt of VICAR label entries assigned to entities of the GDAL data model. Table 1: Metadata entries embedded in the downloadable HRSC product files in compliance with the GDAL data model. IMAGE STRUCTURE PROPERTIES: Spatial reference system (OpenGIS WKT) Affine geotransform Data type/bit depth Compression type RASTER BAND PROPERTIES: Nodata value Offset/scale (reflectance or DTM height) Band statistics Reduced resolution overviews (pyramids) HRSC-SPECIFIC METADATA: Radiance/reflectance offset and scale factors Error/missing/overflow frame counts Geometric calibration file name Best ground sampling distance Macropixel size Three commonly used datasets of HRSC are precalculated from the archived level 4 products - the panchromatic, highest-resolution nadir channel (up to 12.5 m/px) in 8 bit (ND), the DTM referenced to the areoid in 16 bit (DA) and a color composite sharpened by IHS-transformation as 24 bit data (IHS). While the ND and the DA files are directly converted from their VICAR-based archive products, the IHS files are preprocessed from the nadir and the red, green, blue channel (if available). The two datasets based on 8-bit bands (ND and IHS) are converted to GeoJP2000 by the use of GDAL's KakaduTM driver with a reversible (lossless) compression setting. As this driver has currently issues with reversible compression quality in 16 bit, the GeoTiff driver is used for the conversion of the DA product. All three products are ready for quantitative ingestion to GIS environments pre-rendered with band statistics, nodata values, pyramids and complete geo-referencing. Original data values, SRS and meta information of the image sequences or DTM properties are maintained. An example dataset for all three products from orbit 5288 is shown in Figure 2. a) ND b) DA c) IHS Figure 2: Converted HRSC data product (orbit 5288). a) panchromatic nadir image, b) DTM, height over areoid (colorcoded and shaded for illustration), c) pan-sharpened colorcomposite. Outlook For the future, we aim at providing the DA product also in GeoJP2000 format as soon as the problem with the GDAL Kakadu driver is solved. After stabilization of the driver code, we will submit it to the GDAL repository for possible inclusion in the official code base. Photometrically and/or topographically corrected image products [11] are to be incorporated for download if required by the community. Metadata filter options for HRSC data properties may be added for optimized data queries. Acknowledgements This work is supported by the German Space Agency (DLR Bonn), grant 50 QM 1301 (HRSC on Mars Express), on behalf of the German Federal Ministry of Economics and Technology. We thank the HRSC experiment team at DLR Berlin and the HRSC operations team at ESOC for their successful planning, acquisition and processing of the HRSC data. References [1] G. Neukum et al., ESA SP 1240 (2004), 17-35. [2] R. Jaumann et al., PSS 55 (2007), 928-952. [3] K. Gwinner et al., EPSL 294 (2010), 506-519. [4] URL: www-mipl.jpl.nasa.gov/ external/vicar.html. [5] S. H. G. Walter et al., LPS, 40, 2009, #1609. [6] S. H. G. Walter et al., EPSC, 2006, #508. [7] A. Ody et al., JGR Planets 117 (2012). [8] P. C. McGuire et al., LPS (this conference), 45, 2014. [9] URL: www.osgeo.org. [10] URL: http://www.gdal.org/gdal datamodel.html. [11] S. Walter et al., LPS, 43, 2012, #2322.  www-mipl.jpl.nasa.gov/external/vicar.html www-mipl.jpl.nasa.gov/external/vicar.html www.osgeo.org http://www.gdal.org/gdal_datamodel.html