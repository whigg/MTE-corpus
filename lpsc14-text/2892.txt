 Automated and Accurate: Making DTMs from LRO-NAC using the Ames Stereo Pipeline. Zachary M. Moratto1,2, Scott McMichael1,2, Ross A. Beyer2,3, Oleg Alexandrov1,2, and Terry Fong1, 1NASA Ames Research Center, MS 269-3, Moffett Field, CA, USA, 2SGT Inc., and 3Carl Sagan Center at the SETI Institute (Z.M.Moratto@nasa.gov) There are more than a thousand stereo pairs waiting to be processed from the Lunar Reconnaissance Orbiter (LRO) Narrow Angle Camera (NAC) [1]. With the current rate of manual processing, this backlog of imagery won't be completed until almost three decades from now. We present the Ames Stereo Pipeline (ASP) [2] software as a solution to this problem. ASP is a collection of utilities that can take imagery and create a Digital Terrain Model (DTM). However the accuracy of this output DTM is limited by the quality of the camera model provided in ISIS [3] and the spacecraft ephemeris. In this abstract we present a method we've developed for correcting both errors. Introduction Creating a DTM from the full observation of an LRONAC image requires compositing the LE and RE images before sending them to ASP. Simply compositing the two images is incorrect since the LE and RE images come from two different optical assemblies that have a varying angle between their boresights, a delta between time capture, and a physical displacement between each other. This accumulates into a slight perspective change. This can be corrected with ISIS's noproj utility, which projects the imagery off LOLA into an idealized camera. However even with this technique these projected images disagree by some 40 pixels. The errors in most important order are (1) the spacecraft ephemeris has insufficent accurate position; (2) the boresight between optical assemblies of LRO-NAC change with temperature [4] and is not modeled in ISIS; (3) the ISIS camera model does not model the translation between optics. Algorithm A general outline of our technique follows below. Our solution can be summarized as bundle adjusting all images and then using the sparse 3D representation of the surface created by bundle adjustment to perform fitting against LOLA. We use the Ceres library [5] to perform bundle adjustment. All other functions are performed with ISIS, CSPICE [6], and Ames Stereo Pipeline. . Preprocess input imagery with lronac2isis, lronaccal, lronacecho. . Apply known position offset between CCDs by giving custom FK kernels for each image with spiceinit utility. . Capture interest points between all 4 files that constitute a stereo pair (LE1, RE1, LE2, RE2). . Feed measurements to bundle adjustment algorithm parameterized to solve for rotation between LE and RE in single observations and rotation and translation between observations 1 and 2. This produces 3 transforms that we then apply to each file's local ephemeris copy. . Generate sparse point cloud from interest point measurements between all 4 images. . Use ASP 2.3+ utility pc align, an iterative closest point algorithm, to solve for transform between sparse point cloud and raw LOLA measurements. . Apply transform from pc align to each files local ephemeris copy. . Perform noproj and handmos on ephemeris corrected images to create two images from the original four. . Feed mosaicked images to ASPs stereo utility for DTM generation. Results Going through these efforts creates well-aligned imagery that agrees with LOLA measurements better than the results created by ASU. From our limited run of 30 stereo pairs we see that 90% of errors against LOLA are less than 5 meters. More importantly by correcting the relationship between LE and RE CCDs in each observation we are able to remove the vertical edge seen in previous LRO-NAC DTMs created by ASP. This will benefit future hydrological studies that might use this datasets. Future Work Our goal is to process all LRO-NAC stereo pairs using this method and deliver to the PDS by the end of this year. Our current efforts are improving ASP filtering techniques for determining outlier measurements. Once completed, we'll deploy the entire process described here on the Pleiades supercomputer. Our work was funded graciously by NASA SMDs Lunar Advanced Science and Exploration Research (11-LASER11-0112). We would also like to thank Mark Robinson and ASU for supplying the LRO-NAC imagery. References [1] M. S. Robinson, S. M. Brylow, M. Tschimmel, D. Humm, S. J. Lawrence, P. C. Thomas, B. W. Denevi, E. BowmanCisneros, J. Zerr, M. A. Ravine, M. A. Caplinger, F. T.   2Figure 1: (Left) Here we show an ASP DTM result using only noproj and handmoswith no ephemeris corrections. Plotted on top is the difference in meters between LOLA shot points in the same area. (Center) Shown is the ASP result with ephemeris corrections that were shown in this abstract. (Right) For comparison we show the DTM that ASU created from the same imagery. Notice it has simliar error characteristics as the ASU result with ephemeris and camera model correction. Ghaemi, J. A. Schaffner, M. C. Malin, P. Mahanti, A. Bartels, J. Anderson, T. N. Tran, E. M. Eliason, A. S. McEwen, E. Turtle, B. L. Jolliff, and H. Hiesinger. Lunar Reconnaissance Orbiter Camera (LROC) Instrument Overview. 150: 81-124, January 2010. [2] Z. M. Moratto, M. J. Broxton, R. A. Beyer, M. Lundy, and K. Husmann. Ames Stereo Pipeline, NASA's Open Source Automated Stereogrammetry Software. In Lunar and Planetary Institute Science Conference Abstracts, volume 41 of Lunar and Planetary Inst. Technical Report, page 2364, March 2010. [3] USGS Astrogeology Research Program. Integrated software for imagers and spectrometers. http://isis. astrogeology.usgs.gov/. [4] R. V. Wagner, E. J. Speyerer, P. Mahanti, J. Danton, and M. S. Robinson. Pointing Corrections for the Lunar Reconnaissance Orbiter Narrow Angle Cameras. In Lunar and Planetary Institute Science Conference Abstracts, volume 43 of Lunar and Planetary Inst. Technical Report, page 2372, March 2012. [5] Sameer Agarwal, Keir Mierle, and Others. Ceres solver. https://code.google.com/p/ ceres-solver/. [6] C. Acton, N. Bachman, J. Diaz Del Rio, B. Semenov, E. Wright, and Y. Yamamoto. SPICE: A Means for Determining Observation Geometry. In EPSC-DPS Joint Meeting 2011, page 32, October 2011.  http://isis.astrogeology.usgs.gov/ http://isis.astrogeology.usgs.gov/ https://code.google.com/p/ceres-solver/ https://code.google.com/p/ceres-solver/